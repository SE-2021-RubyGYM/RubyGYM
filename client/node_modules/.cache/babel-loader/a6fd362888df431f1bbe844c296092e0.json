{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { append, createElement, extend, EventHandler, prepend, Animation, formatUnit } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, setStyleAttribute, remove, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { EventBase } from './event-base';\nimport * as util from '../base/util';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\r\n * Vertical view appointment rendering\r\n */\n\nvar VerticalEvent =\n/** @class */\nfunction (_super) {\n  __extends(VerticalEvent, _super);\n\n  function VerticalEvent(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.dateRender = [];\n    _this.renderedEvents = [];\n    _this.renderedAllDayEvents = [];\n    _this.overlapEvents = [];\n    _this.moreEvents = [];\n    _this.overlapList = [];\n    _this.allDayEvents = [];\n    _this.slotCount = _this.parent.activeViewOptions.timeScale.slotCount;\n    _this.interval = _this.parent.activeViewOptions.timeScale.interval;\n    _this.allDayLevel = 0;\n    _this.startHour = _this.parent.activeView.getStartHour();\n    _this.endHour = _this.parent.activeView.getEndHour();\n    _this.element = _this.parent.activeView.getPanel();\n    _this.fields = _this.parent.eventFields;\n    _this.animation = new Animation({\n      progress: _this.animationUiUpdate.bind(_this)\n    });\n\n    _this.addEventListener();\n\n    return _this;\n  }\n\n  VerticalEvent.prototype.renderAppointments = function () {\n    if (isNullOrUndefined(this.parent)) {\n      return;\n    }\n\n    if (this.parent.dragAndDropModule) {\n      this.parent.dragAndDropModule.setDragArea();\n    }\n\n    var wrapperElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS + ',.' + cls.APPOINTMENT_CLASS + ',.' + cls.ROW_COUNT_WRAPPER_CLASS));\n    var isDragging = this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction ? true : false;\n\n    for (var _i = 0, wrapperElements_1 = wrapperElements; _i < wrapperElements_1.length; _i++) {\n      var wrapper = wrapperElements_1[_i];\n\n      if (isDragging && !(wrapper.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) || wrapper.classList.contains(cls.ROW_COUNT_WRAPPER_CLASS))) {\n        var groupIndex = parseInt(wrapper.getAttribute('data-group-index'), 10);\n\n        for (var j = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; j < len; j++) {\n          if (groupIndex === this.parent.crudModule.crudObj.sourceEvent[j].groupIndex || groupIndex === this.parent.crudModule.crudObj.targetEvent[j].groupIndex) {\n            remove(wrapper);\n          }\n        }\n      } else {\n        remove(wrapper);\n      }\n    }\n\n    if (!this.element.querySelector('.' + cls.WORK_CELLS_CLASS)) {\n      return;\n    }\n\n    this.allDayElement = [].slice.call(this.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS));\n    this.setAllDayRowHeight(0);\n\n    if (this.parent.eventsProcessed.length === 0 && this.parent.blockProcessed.length === 0) {\n      return;\n    }\n\n    var expandCollapse = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_SECTION_CLASS);\n    EventHandler.remove(expandCollapse, 'click', this.rowExpandCollapse);\n    EventHandler.add(expandCollapse, 'click', this.rowExpandCollapse, this);\n    this.renderedEvents = [];\n    this.renderedAllDayEvents = [];\n    this.initializeValues();\n    this.processBlockEvents();\n    this.renderEvents('normalEvents');\n\n    if (this.allDayEvents.length > 0) {\n      this.allDayEvents = this.allDayEvents.filter(function (item, index, arr) {\n        return index === arr.map(function (item) {\n          return item.Guid;\n        }).indexOf(item.Guid);\n      });\n      removeClass(this.allDayElement, cls.ALLDAY_ROW_ANIMATE_CLASS);\n      this.slots.push(this.parent.activeView.renderDates.map(function (date) {\n        return +date;\n      }));\n      this.renderEvents('allDayEvents');\n    }\n\n    this.parent.notify(events.contentReady, {});\n    addClass(this.allDayElement, cls.ALLDAY_ROW_ANIMATE_CLASS);\n\n    if (isDragging) {\n      this.parent.crudModule.crudObj.isCrudAction = false;\n    }\n\n    this.parent.renderTemplates();\n  };\n\n  VerticalEvent.prototype.initializeValues = function () {\n    this.resources = this.parent.activeViewOptions.group.resources.length > 0 ? this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.resourceBase.lastResourceLevel : [];\n    this.cellHeight = parseFloat(this.parent.element.querySelector('.e-content-wrap tbody tr').getBoundingClientRect().height.toFixed(2));\n    this.dateRender[0] = this.parent.activeView.renderDates;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      for (var i = 0, len = this.resources.length; i < len; i++) {\n        this.dateRender[i] = this.resources[i].renderDates;\n      }\n    }\n  };\n\n  VerticalEvent.prototype.getHeight = function (start, end) {\n    var appHeight = (util.getUniversalTime(end) - util.getUniversalTime(start)) / util.MS_PER_MINUTE * (this.cellHeight * this.slotCount) / this.interval;\n    appHeight = appHeight <= 0 ? this.cellHeight : appHeight;\n    return appHeight;\n  };\n\n  VerticalEvent.prototype.appendEvent = function (eventObj, appointmentElement, index, appLeft) {\n    var appointmentWrap = [].slice.call(this.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n\n    if (this.parent.enableRtl) {\n      setStyleAttribute(appointmentElement, {\n        'right': appLeft\n      });\n    } else {\n      setStyleAttribute(appointmentElement, {\n        'left': appLeft\n      });\n    }\n\n    var eventType = appointmentElement.classList.contains(cls.BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n    var args = {\n      data: extend({}, eventObj, null, true),\n      element: appointmentElement,\n      cancel: false,\n      type: eventType\n    };\n    this.parent.trigger(events.eventRendered, args, function (eventArgs) {\n      if (!eventArgs.cancel) {\n        appointmentWrap[index].appendChild(appointmentElement);\n      }\n    });\n  };\n\n  VerticalEvent.prototype.processBlockEvents = function () {\n    var resources = this.getResourceList();\n    var dateCount = 0;\n\n    for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\n      var resource = resources_1[_i];\n      var renderDates = this.dateRender[resource];\n\n      for (var day = 0, length_1 = renderDates.length; day < length_1; day++) {\n        var startDate = new Date(renderDates[day].getTime());\n        var endDate = util.addDays(renderDates[day], 1);\n        var filterEvents = this.filterEvents(startDate, endDate, this.parent.blockProcessed, this.resources[resource]);\n\n        for (var _a = 0, filterEvents_1 = filterEvents; _a < filterEvents_1.length; _a++) {\n          var event_1 = filterEvents_1[_a];\n\n          if (this.parent.resourceBase) {\n            this.setValues(event_1, resource);\n          }\n\n          this.renderBlockEvents(event_1, day, resource, dateCount);\n          this.cssClass = null;\n          this.groupOrder = null;\n        }\n\n        dateCount += 1;\n      }\n    }\n  };\n\n  VerticalEvent.prototype.renderBlockEvents = function (eventObj, dayIndex, resource, dayCount) {\n    var spannedData = this.isSpannedEvent(eventObj, dayIndex, resource);\n    var eStart = spannedData[this.fields.startTime];\n    var eEnd = spannedData[this.fields.endTime];\n    var currentDate = util.resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\n    var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\n\n    if (eStart <= eEnd && this.isValidEvent(eventObj, eStart, eEnd, schedule)) {\n      var blockTop = void 0;\n      var blockHeight = void 0;\n\n      if (spannedData[this.fields.isAllDay]) {\n        var contentWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\n        blockHeight = formatUnit(contentWrap.offsetHeight);\n        blockTop = formatUnit(0);\n      } else {\n        blockHeight = formatUnit(this.getHeight(eStart, eEnd));\n        blockTop = formatUnit(this.getTopValue(eStart, dayIndex, resource));\n      }\n\n      var appointmentElement = this.createBlockAppointmentElement(eventObj, resource);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': blockHeight,\n        'top': blockTop\n      });\n      var index = this.parent.activeViewOptions.group.byDate ? this.resources.length * dayIndex + resource : dayCount;\n      this.appendEvent(eventObj, appointmentElement, index, '0px');\n    }\n  };\n\n  VerticalEvent.prototype.renderEvents = function (eventType) {\n    removeClass(this.allDayElement, cls.ALLDAY_ROW_ANIMATE_CLASS);\n    var eventCollection = eventType === 'allDayEvents' ? this.sortByDateTime(this.allDayEvents) : undefined;\n    var resources = this.getResourceList();\n    var dateCount = 0;\n    var isRender;\n\n    var _loop_1 = function (resource) {\n      isRender = true;\n\n      if (this_1.parent.crudModule && this_1.parent.crudModule.crudObj.isCrudAction && eventType !== 'allDayEvents' && !this_1.parent.uiStateValues.isGroupAdaptive) {\n        if (this_1.parent.crudModule.crudObj.sourceEvent.filter(function (data) {\n          return data.groupIndex === resource;\n        }).length === 0 && this_1.parent.crudModule.crudObj.targetEvent.filter(function (data) {\n          return data.groupIndex === resource;\n        }).length === 0) {\n          isRender = false;\n        }\n      }\n\n      this_1.slots = [];\n      var renderDates = this_1.dateRender[resource];\n      var renderedDate = this_1.getRenderedDates(renderDates) || renderDates;\n      this_1.slots.push(renderDates.map(function (date) {\n        return +date;\n      }));\n\n      for (var day = 0, length_2 = renderDates.length; day < length_2 && renderDates[day] <= renderedDate[renderedDate.length - 1]; day++) {\n        this_1.renderedEvents = [];\n        var startDate = new Date(renderDates[day].getTime());\n        var endDate = util.addDays(renderDates[day], 1);\n        var filterEvents = this_1.filterEvents(startDate, endDate, eventCollection, this_1.resources[resource]);\n\n        if (isRender) {\n          for (var _i = 0, filterEvents_2 = filterEvents; _i < filterEvents_2.length; _i++) {\n            var event_2 = filterEvents_2[_i];\n\n            if (this_1.parent.resourceBase) {\n              this_1.setValues(event_2, resource);\n            }\n\n            if (eventType === 'allDayEvents') {\n              this_1.renderAllDayEvents(event_2, day, resource, dateCount);\n            } else {\n              if (this_1.isAllDayAppointment(event_2)) {\n                this_1.allDayEvents.push(extend({}, event_2, null, true));\n              } else {\n                if (this_1.parent.eventSettings.enableMaxHeight) {\n                  if (this_1.getOverlapIndex(event_2, day, false, resource) > 0) {\n                    continue;\n                  }\n                }\n\n                this_1.renderNormalEvents(event_2, day, resource, dateCount);\n              }\n            }\n\n            this_1.cssClass = null;\n            this_1.groupOrder = null;\n          }\n        } else {\n          for (var _a = 0, filterEvents_3 = filterEvents; _a < filterEvents_3.length; _a++) {\n            var event_3 = filterEvents_3[_a];\n\n            if (this_1.isAllDayAppointment(event_3)) {\n              this_1.allDayEvents.push(extend({}, event_3, null, true));\n            }\n          }\n        }\n\n        dateCount += 1;\n      }\n    };\n\n    var this_1 = this;\n\n    for (var _i = 0, resources_2 = resources; _i < resources_2.length; _i++) {\n      var resource = resources_2[_i];\n\n      _loop_1(resource);\n    }\n  };\n\n  VerticalEvent.prototype.setValues = function (event, resourceIndex) {\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.cssClass = this.resources[resourceIndex].cssClass;\n      this.groupOrder = this.resources[resourceIndex].groupOrder;\n    } else {\n      this.cssClass = this.parent.resourceBase.getCssClass(event);\n    }\n  };\n\n  VerticalEvent.prototype.getResourceList = function () {\n    // eslint-disable-next-line prefer-spread\n    var resources = Array.apply(null, {\n      length: this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive ? this.resources.length : 1\n    }).map(function (value, index) {\n      return index;\n    });\n    return resources;\n  }; // eslint-disable-next-line max-len\n\n\n  VerticalEvent.prototype.createAppointmentElement = function (record, isAllDay, data, resource) {\n    var fieldMapping = this.parent.eventFields;\n    var recordSubject = record[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n    var appointmentWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS,\n      attrs: {\n        'data-id': 'Appointment_' + record[fieldMapping.id],\n        'data-guid': record.Guid,\n        'role': 'button',\n        'tabindex': '0',\n        'aria-readonly': this.parent.eventBase.getReadonlyAttribute(record),\n        'aria-selected': 'false',\n        'aria-grabbed': 'true',\n        'aria-label': this.parent.getAnnouncementString(record)\n      }\n    });\n\n    if (record[this.fields.isReadonly]) {\n      addClass([appointmentWrapper], 'e-read-only');\n    }\n\n    var appointmentDetails = createElement('div', {\n      className: cls.APPOINTMENT_DETAILS\n    });\n    appointmentWrapper.appendChild(appointmentDetails);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      var resourceIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : resource;\n      appointmentWrapper.setAttribute('data-group-index', resourceIndex.toString());\n    }\n\n    var templateElement;\n    var eventData = data;\n\n    if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n      var elementId = this.parent.element.id + '_';\n      var viewName = this.parent.activeViewOptions.eventTemplateName;\n      var templateId = elementId + viewName + 'eventTemplate';\n      templateElement = this.parent.getAppointmentTemplate()(record, this.parent, 'eventTemplate', templateId, false);\n    } else {\n      var appointmentSubject = createElement('div', {\n        className: cls.SUBJECT_CLASS,\n        innerHTML: recordSubject\n      });\n\n      if (isAllDay) {\n        if (record[fieldMapping.isAllDay]) {\n          templateElement = [appointmentSubject];\n        } else {\n          templateElement = [];\n          var appointmentStartTime = createElement('div', {\n            className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n            innerHTML: this.parent.getTimeString(record[fieldMapping.startTime])\n          });\n          var appointmentEndTime = createElement('div', {\n            className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n            innerHTML: this.parent.getTimeString(record[fieldMapping.endTime])\n          });\n          addClass([appointmentSubject], 'e-text-center');\n\n          if (!eventData.isLeft) {\n            templateElement.push(appointmentStartTime);\n          }\n\n          templateElement.push(appointmentSubject);\n\n          if (!eventData.isRight) {\n            templateElement.push(appointmentEndTime);\n          }\n        }\n      } else {\n        var timeStr = this.parent.getTimeString(record[fieldMapping.startTime]) + ' - ' + this.parent.getTimeString(record[fieldMapping.endTime]);\n        var appointmentTime = createElement('div', {\n          className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n          innerHTML: timeStr\n        });\n        var appointmentLocation = createElement('div', {\n          className: cls.LOCATION_CLASS,\n          innerHTML: record[fieldMapping.location] || this.parent.eventSettings.fields.location.default || ''\n        });\n        templateElement = [appointmentSubject, appointmentTime, appointmentLocation];\n      }\n    }\n\n    append(templateElement, appointmentDetails);\n\n    if (!this.parent.isAdaptive && (!isNullOrUndefined(record[fieldMapping.recurrenceRule]) || !isNullOrUndefined(record[fieldMapping.recurrenceID]))) {\n      var iconClass = record[fieldMapping.id] === record[fieldMapping.recurrenceID] ? cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n      var recurrenceIcon = createElement('div', {\n        className: cls.ICON + ' ' + iconClass\n      });\n\n      if (isAllDay) {\n        appointmentDetails.appendChild(recurrenceIcon);\n      } else {\n        appointmentWrapper.appendChild(recurrenceIcon);\n      }\n    }\n\n    this.renderSpannedIcon(isAllDay ? appointmentDetails : appointmentWrapper, eventData);\n\n    if (!isNullOrUndefined(this.cssClass)) {\n      addClass([appointmentWrapper], this.cssClass);\n    }\n\n    this.applyResourceColor(appointmentWrapper, record, 'backgroundColor', this.groupOrder);\n    this.renderResizeHandler(appointmentWrapper, eventData, record[this.fields.isReadonly]);\n    return appointmentWrapper;\n  };\n\n  VerticalEvent.prototype.createMoreIndicator = function (allDayRow, count, currentDay) {\n    var index = currentDay + count;\n    var countWrapper = allDayRow[index];\n\n    if (countWrapper.childElementCount <= 0) {\n      var innerCountWrap = createElement('div', {\n        className: cls.ROW_COUNT_WRAPPER_CLASS,\n        id: cls.ROW_COUNT_WRAPPER_CLASS + '-' + index.toString()\n      });\n      var moreIndicatorElement = createElement('div', {\n        className: cls.MORE_INDICATOR_CLASS,\n        attrs: {\n          'tabindex': '0',\n          'role': 'list',\n          'data-index': index.toString(),\n          'data-count': '1'\n        },\n        innerHTML: '+1&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'))\n      });\n      innerCountWrap.appendChild(moreIndicatorElement);\n      countWrapper.appendChild(innerCountWrap);\n      EventHandler.add(moreIndicatorElement, 'click', this.rowExpandCollapse, this);\n    } else {\n      var countCell = countWrapper.querySelector('.' + cls.MORE_INDICATOR_CLASS);\n      var moreCount = parseInt(countCell.getAttribute('data-count'), 10) + 1;\n      countCell.setAttribute('data-count', moreCount.toString());\n      countCell.innerHTML = '+' + this.parent.globalize.formatNumber(moreCount) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\n    }\n  };\n\n  VerticalEvent.prototype.renderSpannedIcon = function (element, spanEvent) {\n    var iconElement = createElement('div', {\n      className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON\n    });\n\n    if (spanEvent.isLeft) {\n      var iconLeft = iconElement.cloneNode();\n      addClass([iconLeft], cls.EVENT_ICON_LEFT_CLASS);\n      prepend([iconLeft], element);\n    }\n\n    if (spanEvent.isRight) {\n      var iconRight = iconElement.cloneNode();\n      addClass([iconRight], cls.EVENT_ICON_RIGHT_CLASS);\n      append([iconRight], element);\n    }\n\n    if (spanEvent.isTop) {\n      var iconTop = iconElement.cloneNode();\n      addClass([iconTop], cls.EVENT_ICON_UP_CLASS);\n      prepend([iconTop], element);\n    }\n\n    if (spanEvent.isBottom) {\n      var iconBottom = iconElement.cloneNode();\n      addClass([iconBottom], cls.EVENT_ICON_DOWN_CLASS);\n      append([iconBottom], element);\n    }\n  };\n\n  VerticalEvent.prototype.isSpannedEvent = function (record, day, resource) {\n    var currentDate = util.resetTime(this.dateRender[resource][day]);\n    var renderedDate = this.getRenderedDates(this.dateRender[resource]) || [currentDate];\n    var currentDay = renderedDate.filter(function (date) {\n      return date.getDay() === day;\n    });\n\n    if (currentDay.length === 0) {\n      currentDate = util.resetTime(renderedDate[0]);\n    }\n\n    var field = this.parent.eventFields;\n    var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\n    var event = extend({}, record, null, true);\n    event.isSpanned = {\n      isBottom: false,\n      isTop: false\n    };\n\n    if (record[field.startTime].getTime() < schedule.startHour.getTime()) {\n      event[field.startTime] = schedule.startHour;\n      event.isSpanned.isTop = true;\n    }\n\n    if (record[field.endTime].getTime() > schedule.endHour.getTime()) {\n      event[field.endTime] = schedule.endHour;\n      event.isSpanned.isBottom = true;\n    }\n\n    var eventDates = this.updateEventMinimumDuration(schedule, event[field.startTime], event[field.endTime]);\n    event[field.startTime] = eventDates.startDate;\n    event[field.endTime] = eventDates.endDate;\n    return event;\n  };\n\n  VerticalEvent.prototype.renderAllDayEvents = function (eventObj, dayIndex, resource, dayCount, inline) {\n    var _this = this;\n\n    var currentDates = this.getRenderedDates(this.dateRender[resource]) || this.dateRender[resource];\n\n    if (this.parent.activeViewOptions.group.byDate) {\n      this.slots[0] = [this.dateRender[resource][dayIndex].getTime()];\n      currentDates = [this.dateRender[resource][dayIndex]];\n    }\n\n    var record = this.splitEvent(eventObj, currentDates)[0];\n    var allDayRowCell = this.element.querySelector('.' + cls.ALLDAY_CELLS_CLASS + ':first-child');\n    var cellTop = allDayRowCell.offsetTop;\n    var eStart = new Date(record[this.parent.eventFields.startTime].getTime());\n    var eEnd = new Date(record[this.parent.eventFields.endTime].getTime());\n    var appWidth = 0;\n    var topValue = 1;\n    var isDateRange = currentDates[0].getTime() <= eStart.getTime() && util.addDays(currentDates.slice(-1)[0], 1).getTime() >= eStart.getTime();\n\n    if (eStart <= eEnd && isDateRange) {\n      var isAlreadyRendered = [];\n\n      if (this.renderedAllDayEvents[resource]) {\n        isAlreadyRendered = this.renderedAllDayEvents[resource].filter(function (event) {\n          return event.Guid === eventObj.Guid;\n        });\n\n        if (this.parent.activeViewOptions.group.byDate) {\n          isAlreadyRendered = isAlreadyRendered.filter(function (event) {\n            return event[_this.parent.eventFields.startTime] >= currentDates[dayIndex] && event[_this.parent.eventFields.endTime] <= util.addDays(new Date(+currentDates[dayIndex]), 1);\n          });\n        }\n      }\n\n      if (isAlreadyRendered.length === 0) {\n        var allDayDifference_1 = record.data.count;\n        var allDayIndex_1 = this.getOverlapIndex(record, dayIndex, true, resource);\n        record.Index = allDayIndex_1;\n        this.allDayLevel = this.allDayLevel < allDayIndex_1 ? allDayIndex_1 : this.allDayLevel;\n        var widthAdjustment = record.data.isRight ? 0 : this.parent.currentView === 'Day' ? 4 : 7;\n\n        if (allDayDifference_1 >= 0) {\n          appWidth = allDayDifference_1 * 100 - widthAdjustment;\n        }\n\n        if (isNullOrUndefined(this.renderedAllDayEvents[resource])) {\n          this.renderedAllDayEvents[resource] = [];\n        }\n\n        this.renderedAllDayEvents[resource].push(extend({}, record, null, true));\n        var allDayRow_1 = [].slice.call(this.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).children);\n        var wIndex_1 = this.parent.activeViewOptions.group.byDate ? this.resources.length * dayIndex + resource : dayCount;\n        var eventWrapper_1 = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS + ':nth-child(' + (wIndex_1 + 1) + ')');\n        var appointmentElement_1;\n\n        if (inline) {\n          appointmentElement_1 = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\n        } else {\n          appointmentElement_1 = this.createAppointmentElement(eventObj, true, record.data, resource);\n        }\n\n        addClass([appointmentElement_1], cls.ALLDAY_APPOINTMENT_CLASS);\n        var args = {\n          data: eventObj,\n          element: appointmentElement_1,\n          cancel: false\n        };\n        this.parent.trigger(events.eventRendered, args, function (eventArgs) {\n          if (!eventArgs.cancel) {\n            eventWrapper_1.appendChild(appointmentElement_1);\n            var appHeight = appointmentElement_1.offsetHeight;\n            topValue += (allDayIndex_1 === 0 ? cellTop : cellTop + allDayIndex_1 * appHeight) + 1;\n            setStyleAttribute(appointmentElement_1, {\n              'width': appWidth + '%',\n              'top': formatUnit(topValue)\n            });\n\n            if (allDayIndex_1 > 1) {\n              _this.moreEvents.push(appointmentElement_1);\n\n              for (var count = 0, length_3 = allDayDifference_1; count < length_3; count++) {\n                _this.createMoreIndicator(allDayRow_1, count, wIndex_1);\n              }\n            }\n\n            allDayRowCell.setAttribute('data-count', _this.allDayLevel.toString());\n            var allDayRowHeight = (!_this.parent.uiStateValues.expand && _this.allDayLevel > 2 ? 3 * appHeight : (_this.allDayLevel + 1) * appHeight) + 4;\n\n            _this.setAllDayRowHeight(allDayRowHeight);\n\n            _this.addOrRemoveClass();\n\n            _this.wireAppointmentEvents(appointmentElement_1, eventObj);\n          }\n        });\n      }\n    }\n  };\n\n  VerticalEvent.prototype.renderNormalEvents = function (eventObj, dayIndex, resource, dayCount, inline) {\n    var record = this.isSpannedEvent(eventObj, dayIndex, resource);\n    var eStart = record[this.fields.startTime];\n    var eEnd = record[this.fields.endTime];\n    var appWidth = '0%';\n    var appLeft = '0%';\n    var topValue = 0;\n    var currentDate = util.resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\n    var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\n    var isValidEvent = this.isValidEvent(eventObj, eStart, eEnd, schedule);\n\n    if (eStart <= eEnd && isValidEvent) {\n      var appHeight_1 = this.getHeight(eStart, eEnd);\n\n      if (eStart.getTime() > schedule.startHour.getTime()) {\n        topValue = this.getTopValue(eStart, dayIndex, resource);\n      }\n\n      var appIndex = this.getOverlapIndex(record, dayIndex, false, resource);\n      record.Index = appIndex;\n      this.overlapList.push(record);\n\n      if (this.overlapList.length > 1) {\n        if (isNullOrUndefined(this.overlapEvents[appIndex])) {\n          this.overlapEvents[appIndex] = [];\n        }\n\n        this.overlapEvents[appIndex].push(record);\n      } else {\n        this.overlapEvents = [];\n        this.overlapEvents.push([record]);\n      }\n\n      appWidth = this.getEventWidth();\n      var argsData = {\n        index: appIndex,\n        left: appLeft,\n        width: appWidth,\n        day: dayIndex,\n        dayIndex: dayCount,\n        record: record,\n        resource: resource\n      };\n      var tempData = this.adjustOverlapElements(argsData);\n      appWidth = tempData.appWidth;\n\n      if (isNullOrUndefined(this.renderedEvents[resource])) {\n        this.renderedEvents[resource] = [];\n      }\n\n      this.renderedEvents[resource].push(extend({}, record, null, true));\n      var appointmentElement = void 0;\n\n      if (inline) {\n        appointmentElement = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\n      } else {\n        appointmentElement = this.createAppointmentElement(eventObj, false, record.isSpanned, resource);\n      }\n\n      setStyleAttribute(appointmentElement, {\n        'width': this.parent.eventSettings.enableMaxHeight ? '100%' : tempData.appWidth,\n        'height': appHeight_1 + 'px',\n        'top': topValue + 'px'\n      });\n      var iconHeight = appointmentElement.querySelectorAll('.' + cls.EVENT_INDICATOR_CLASS).length * 15;\n      var maxHeight = appHeight_1 - 40 - iconHeight;\n      var subjectElement = appointmentElement.querySelector('.' + cls.SUBJECT_CLASS);\n\n      if (!this.parent.isAdaptive && subjectElement) {\n        subjectElement.style.maxHeight = formatUnit(maxHeight);\n      }\n\n      var index = this.parent.activeViewOptions.group.byDate ? this.resources.length * dayIndex + resource : dayCount;\n      this.appendEvent(eventObj, appointmentElement, index, tempData.appLeft);\n      this.wireAppointmentEvents(appointmentElement, eventObj);\n\n      if (appHeight_1 < this.cellHeight) {\n        var resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + cls.EVENT_RESIZE_CLASS));\n        resizeHandlers.forEach(function (resizeHandler) {\n          resizeHandler.style.height = Math.ceil(appHeight_1 / resizeHandler.offsetHeight) + 'px';\n        });\n      }\n    }\n  };\n\n  VerticalEvent.prototype.getEventWidth = function () {\n    var width = this.parent.currentView === 'Day' ? 97 : 94;\n    var tempWidth = (width - this.overlapEvents.length) / this.overlapEvents.length;\n    return (tempWidth < 0 ? 0 : tempWidth) + '%';\n  };\n\n  VerticalEvent.prototype.getEventLeft = function (appWidth, index) {\n    var tempLeft = (parseFloat(appWidth) + 1) * index;\n    return (tempLeft > 99 ? 99 : tempLeft) + '%';\n  };\n\n  VerticalEvent.prototype.getTopValue = function (date, day, resource) {\n    var startEndHours = util.getStartEndHours(util.resetTime(this.dateRender[resource][day]), this.startHour, this.endHour);\n    var startHour = startEndHours.startHour;\n    var diffInMinutes = (date.getHours() - startHour.getHours()) * 60 + (date.getMinutes() - startHour.getMinutes());\n    return this.parent.activeViewOptions.timeScale.enable ? diffInMinutes * this.cellHeight * this.slotCount / this.interval : 0;\n  };\n\n  VerticalEvent.prototype.getOverlapIndex = function (record, day, isAllDay, resource) {\n    var _this = this;\n\n    var fieldMapping = this.parent.eventFields;\n    var eventsList = [];\n    var appIndex = -1;\n    this.overlapEvents = [];\n\n    if (isAllDay) {\n      if (!isNullOrUndefined(this.renderedAllDayEvents[resource])) {\n        var date_1 = util.resetTime(new Date(this.dateRender[resource][day].getTime()));\n        eventsList = this.renderedAllDayEvents[resource].filter(function (app) {\n          return util.resetTime(app[fieldMapping.startTime]).getTime() <= date_1.getTime() && util.resetTime(app[fieldMapping.endTime]).getTime() >= date_1.getTime();\n        });\n\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          eventsList = this.filterEventsByResource(this.resources[resource], eventsList);\n        }\n      }\n    } else {\n      var appointmentList_1 = !isNullOrUndefined(this.renderedEvents[resource]) ? this.renderedEvents[resource] : [];\n      var appointment_1 = [];\n      var recordStart_1 = record[fieldMapping.startTime];\n      var recordEnd_1 = record[fieldMapping.endTime];\n      this.overlapList = appointmentList_1.filter(function (data) {\n        return data[fieldMapping.endTime] > recordStart_1 && data[fieldMapping.startTime] <= recordEnd_1 || data[fieldMapping.startTime] >= recordEnd_1 && data[fieldMapping.endTime] <= recordStart_1 || data[fieldMapping.endTime].getTime() === data[fieldMapping.startTime].getTime() && data[fieldMapping.startTime].getTime() === recordStart_1.getTime() && data[fieldMapping.endTime] < recordEnd_1;\n      });\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.overlapList = this.filterEventsByResource(this.resources[resource], this.overlapList);\n      }\n\n      this.overlapList.forEach(function (obj) {\n        var filterList = appointmentList_1.filter(function (data) {\n          return data[fieldMapping.endTime] > obj[fieldMapping.startTime] && data[fieldMapping.startTime] <= obj[fieldMapping.endTime];\n        });\n\n        if (_this.parent.activeViewOptions.group.resources.length > 0) {\n          filterList = _this.filterEventsByResource(_this.resources[resource], filterList);\n        }\n\n        var collection = filterList.filter(function (val) {\n          return _this.overlapList.indexOf(val) === -1;\n        });\n\n        if (collection.length > 0) {\n          appointment_1 = appointment_1.concat(collection);\n        }\n      });\n\n      for (var i = 0; i < appointment_1.length - 1; i++) {\n        for (var j = i + 1; j < appointment_1.length; j++) {\n          if (appointment_1[i][fieldMapping.id] === appointment_1[j][fieldMapping.id]) {\n            appointment_1.splice(j, 1);\n            j--;\n          }\n        }\n      }\n\n      this.overlapList = this.overlapList.concat(appointment_1);\n      eventsList = this.overlapList;\n\n      for (var _i = 0, eventsList_1 = eventsList; _i < eventsList_1.length; _i++) {\n        var event_4 = eventsList_1[_i];\n        var record_1 = event_4;\n        var index = record_1.Index;\n\n        if (isNullOrUndefined(this.overlapEvents[index])) {\n          this.overlapEvents[index] = [event_4];\n        } else {\n          this.overlapEvents[index].push(event_4);\n        }\n      }\n    }\n\n    if (!isAllDay) {\n      eventsList = eventsList.filter(function (obj) {\n        return obj[fieldMapping.startTime] === record[fieldMapping.startTime] && obj[fieldMapping.endTime] > record[fieldMapping.endTime] || obj[fieldMapping.endTime] > record[fieldMapping.startTime] && obj[fieldMapping.startTime] < record[fieldMapping.endTime] || obj[fieldMapping.endTime] === record[fieldMapping.startTime] && obj[fieldMapping.startTime] === record[fieldMapping.endTime] || obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() && obj[fieldMapping.endTime].getTime() === record[fieldMapping.endTime].getTime() || obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() && obj[fieldMapping.endTime].getTime() < record[fieldMapping.endTime].getTime() || obj[fieldMapping.endTime].getTime() > record[fieldMapping.endTime].getTime();\n      });\n    }\n\n    if (eventsList.length > 0) {\n      var appLevel = eventsList.map(function (obj) {\n        return obj.Index;\n      });\n      appIndex = appLevel.length > 0 ? this.getSmallestMissingNumber(appLevel) : 0;\n    }\n\n    return appIndex === -1 ? 0 : appIndex;\n  };\n\n  VerticalEvent.prototype.adjustOverlapElements = function (args) {\n    var data = {\n      appWidth: args.width,\n      appLeft: args.left\n    };\n\n    for (var i = 0, length1 = this.overlapEvents.length; i < length1; i++) {\n      if (!isNullOrUndefined(this.overlapEvents[i])) {\n        for (var j = 0, length2 = this.overlapEvents[i].length; j < length2; j++) {\n          var dayCount = this.parent.activeViewOptions.group.byDate ? this.resources.length * args.day + args.resource : args.dayIndex;\n          var element = this.element.querySelector('#e-appointment-wrapper-' + dayCount);\n\n          if (element.childElementCount > 0) {\n            var eleGuid = this.overlapEvents[i][j].Guid;\n\n            if (element.querySelectorAll('div[data-guid=\"' + eleGuid + '\"]').length > 0 && eleGuid !== args.record.Guid) {\n              var apps = element.querySelector('div[data-guid=\"' + eleGuid + '\"]');\n\n              if (parseFloat(args.width) <= parseFloat(apps.style.width)) {\n                if (this.parent.enableRtl) {\n                  apps.style.right = this.getEventLeft(args.width, i);\n                } else {\n                  apps.style.left = this.getEventLeft(args.width, i);\n                }\n\n                apps.style.width = parseFloat(args.width) + '%';\n                data.appWidth = apps.style.width;\n              } else {\n                data.appWidth = apps.style.width;\n              }\n            } else {\n              var appWidth = args.width;\n\n              if (isNullOrUndefined(this.overlapEvents[i - 1])) {\n                appWidth = this.getEventWidth();\n              }\n\n              data.appWidth = appWidth;\n              data.appLeft = this.getEventLeft(appWidth, args.index);\n            }\n          }\n        }\n      }\n    }\n\n    return data;\n  };\n\n  VerticalEvent.prototype.setAllDayRowHeight = function (height) {\n    var dateHeader = this.parent.element.querySelector('.' + cls.DATE_HEADER_WRAP_CLASS);\n\n    if (this.parent.height === 'auto' || !this.parent.enableAllDayScroll) {\n      addClass([dateHeader], cls.ALLDAY_APPOINTMENT_AUTO);\n    }\n\n    var allDayRow = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    allDayRow.style.height = '';\n\n    if (this.parent.uiStateValues.expand && this.parent.height !== 'auto' && this.parent.enableAllDayScroll) {\n      allDayRow.style.height = height / 12 + 'em';\n      this.parent.eventBase.allDayExpandScroll(dateHeader);\n    } else {\n      dateHeader.scrollTop = 0;\n\n      for (var _i = 0, _a = this.allDayElement; _i < _a.length; _i++) {\n        var element = _a[_i];\n        element.style.height = height / 12 + 'em';\n      }\n\n      removeClass([dateHeader], cls.ALLDAY_APPOINTMENT_SCROLL);\n    }\n\n    this.animation.animate(this.allDayElement[0]);\n  };\n\n  VerticalEvent.prototype.addOrRemoveClass = function () {\n    var _this = this;\n\n    this.moreEvents.filter(function (element) {\n      if (!_this.parent.uiStateValues.expand && _this.allDayLevel > 2) {\n        addClass([element], cls.EVENT_COUNT_CLASS);\n        element.setAttribute('tabindex', '-1');\n      } else {\n        removeClass([element], cls.EVENT_COUNT_CLASS);\n        element.setAttribute('tabindex', '0');\n      }\n    });\n    var moreEventCount = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_SECTION_CLASS);\n\n    if (this.parent.uiStateValues.expand) {\n      removeClass([moreEventCount], cls.APPOINTMENT_ROW_EXPAND_CLASS);\n      addClass([moreEventCount], cls.APPOINTMENT_ROW_COLLAPSE_CLASS);\n    } else {\n      removeClass([moreEventCount], cls.APPOINTMENT_ROW_COLLAPSE_CLASS);\n      addClass([moreEventCount], cls.APPOINTMENT_ROW_EXPAND_CLASS);\n    }\n\n    if (this.allDayLevel > 2) {\n      removeClass([moreEventCount], cls.DISABLE_CLASS);\n    } else {\n      addClass([moreEventCount], cls.DISABLE_CLASS);\n    }\n\n    var countCell = [].slice.call(this.element.querySelectorAll('.' + cls.ROW_COUNT_WRAPPER_CLASS));\n    countCell.forEach(function (element) {\n      if (!_this.parent.uiStateValues.expand && _this.allDayLevel > 2) {\n        removeClass([element], cls.DISABLE_CLASS);\n      } else {\n        addClass([element], cls.DISABLE_CLASS);\n      }\n    });\n  };\n\n  VerticalEvent.prototype.getEventHeight = function () {\n    var eventElement = createElement('div', {\n      className: cls.APPOINTMENT_CLASS,\n      styles: 'visibility:hidden'\n    });\n    var eventWrapper = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS + ':first-child');\n    eventWrapper.appendChild(eventElement);\n    var height = eventElement.offsetHeight;\n    remove(eventElement);\n    return height;\n  };\n\n  VerticalEvent.prototype.rowExpandCollapse = function () {\n    var target = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_SECTION_CLASS);\n    this.parent.uiStateValues.expand = target.classList.contains(cls.APPOINTMENT_ROW_EXPAND_CLASS);\n    var rowHeight;\n\n    if (this.parent.uiStateValues.expand) {\n      target.setAttribute('title', this.parent.localeObj.getConstant('collapseAllDaySection'));\n      target.setAttribute('aria-label', 'Collapse section');\n      rowHeight = (this.allDayLevel + 1) * this.getEventHeight() + 4;\n    } else {\n      target.setAttribute('title', this.parent.localeObj.getConstant('expandAllDaySection'));\n      target.setAttribute('aria-label', 'Expand section');\n      rowHeight = 3 * this.getEventHeight() + 4;\n    }\n\n    this.setAllDayRowHeight(rowHeight);\n    this.addOrRemoveClass();\n    this.animation.animate(target);\n  };\n\n  VerticalEvent.prototype.animationUiUpdate = function () {\n    this.parent.notify(events.contentReady, {});\n  };\n\n  VerticalEvent.prototype.destroy = function () {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.removeEventListener();\n    this.allDayElement = null;\n    this.renderedAllDayEvents = null;\n    this.renderedEvents = null;\n    this.slotCount = null;\n    this.interval = null;\n    this.startHour = null;\n    this.endHour = null;\n    this.element = null;\n    this.fields = null;\n    this.animation = null;\n\n    _super.prototype.destroy.call(this);\n  };\n\n  return VerticalEvent;\n}(EventBase);\n\nexport { VerticalEvent };","map":{"version":3,"sources":["D:/HUST/20211/Introduction to Software Engineering/Project/Sprint 2/RubyGYM/client/node_modules/@syncfusion/ej2-schedule/src/schedule/event-renderer/vertical-view.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","append","createElement","extend","EventHandler","prepend","Animation","formatUnit","isNullOrUndefined","setStyleAttribute","remove","removeClass","addClass","EventBase","util","events","cls","VerticalEvent","_super","parent","_this","call","dateRender","renderedEvents","renderedAllDayEvents","overlapEvents","moreEvents","overlapList","allDayEvents","slotCount","activeViewOptions","timeScale","interval","allDayLevel","startHour","activeView","getStartHour","endHour","getEndHour","element","getPanel","fields","eventFields","animation","progress","animationUiUpdate","bind","addEventListener","renderAppointments","dragAndDropModule","setDragArea","wrapperElements","slice","querySelectorAll","BLOCK_APPOINTMENT_CLASS","APPOINTMENT_CLASS","ROW_COUNT_WRAPPER_CLASS","isDragging","crudModule","crudObj","isCrudAction","_i","wrapperElements_1","length","wrapper","classList","contains","ALLDAY_APPOINTMENT_CLASS","groupIndex","parseInt","getAttribute","j","len","sourceEvent","targetEvent","querySelector","WORK_CELLS_CLASS","allDayElement","ALLDAY_CELLS_CLASS","setAllDayRowHeight","eventsProcessed","blockProcessed","expandCollapse","ALLDAY_APPOINTMENT_SECTION_CLASS","rowExpandCollapse","add","initializeValues","processBlockEvents","renderEvents","filter","item","index","arr","map","Guid","indexOf","ALLDAY_ROW_ANIMATE_CLASS","slots","push","renderDates","date","notify","contentReady","renderTemplates","resources","group","uiStateValues","isGroupAdaptive","resourceBase","lastResourceLevel","cellHeight","parseFloat","getBoundingClientRect","height","toFixed","i","getHeight","start","end","appHeight","getUniversalTime","MS_PER_MINUTE","appendEvent","eventObj","appointmentElement","appLeft","appointmentWrap","APPOINTMENT_WRAPPER_CLASS","enableRtl","eventType","args","data","cancel","type","trigger","eventRendered","eventArgs","appendChild","getResourceList","dateCount","resources_1","resource","day","length_1","startDate","Date","getTime","endDate","addDays","filterEvents","_a","filterEvents_1","event_1","setValues","renderBlockEvents","cssClass","groupOrder","dayIndex","dayCount","spannedData","isSpannedEvent","eStart","startTime","eEnd","endTime","currentDate","resetTime","schedule","getStartEndHours","isValidEvent","blockTop","blockHeight","isAllDay","contentWrap","CONTENT_WRAP_CLASS","offsetHeight","getTopValue","createBlockAppointmentElement","byDate","eventCollection","sortByDateTime","undefined","isRender","_loop_1","this_1","renderedDate","getRenderedDates","length_2","filterEvents_2","event_2","renderAllDayEvents","isAllDayAppointment","eventSettings","enableMaxHeight","getOverlapIndex","renderNormalEvents","filterEvents_3","event_3","resources_2","event","resourceIndex","getCssClass","apply","value","createAppointmentElement","record","fieldMapping","recordSubject","subject","default","localeObj","getConstant","appointmentWrapper","className","attrs","id","eventBase","getReadonlyAttribute","getAnnouncementString","isReadonly","appointmentDetails","APPOINTMENT_DETAILS","setAttribute","toString","templateElement","eventData","eventTemplate","elementId","viewName","eventTemplateName","templateId","getAppointmentTemplate","appointmentSubject","SUBJECT_CLASS","innerHTML","appointmentStartTime","APPOINTMENT_TIME","isAdaptive","DISABLE_CLASS","getTimeString","appointmentEndTime","isLeft","isRight","timeStr","appointmentTime","appointmentLocation","LOCATION_CLASS","location","recurrenceRule","recurrenceID","iconClass","EVENT_RECURRENCE_ICON_CLASS","EVENT_RECURRENCE_EDIT_ICON_CLASS","recurrenceIcon","ICON","renderSpannedIcon","applyResourceColor","renderResizeHandler","createMoreIndicator","allDayRow","count","currentDay","countWrapper","childElementCount","innerCountWrap","moreIndicatorElement","MORE_INDICATOR_CLASS","countCell","moreCount","globalize","formatNumber","spanEvent","iconElement","EVENT_INDICATOR_CLASS","iconLeft","cloneNode","EVENT_ICON_LEFT_CLASS","iconRight","EVENT_ICON_RIGHT_CLASS","isTop","iconTop","EVENT_ICON_UP_CLASS","isBottom","iconBottom","EVENT_ICON_DOWN_CLASS","getDay","field","isSpanned","eventDates","updateEventMinimumDuration","inline","currentDates","splitEvent","allDayRowCell","cellTop","offsetTop","appWidth","topValue","isDateRange","isAlreadyRendered","allDayDifference_1","allDayIndex_1","Index","widthAdjustment","currentView","allDayRow_1","ALLDAY_ROW_CLASS","children","wIndex_1","eventWrapper_1","ALLDAY_APPOINTMENT_WRAPPER_CLASS","appointmentElement_1","inlineModule","createInlineAppointmentElement","length_3","allDayRowHeight","expand","addOrRemoveClass","wireAppointmentEvents","appHeight_1","appIndex","getEventWidth","argsData","left","width","tempData","adjustOverlapElements","iconHeight","maxHeight","subjectElement","style","resizeHandlers","EVENT_RESIZE_CLASS","forEach","resizeHandler","Math","ceil","tempWidth","getEventLeft","tempLeft","startEndHours","diffInMinutes","getHours","getMinutes","enable","eventsList","date_1","app","filterEventsByResource","appointmentList_1","appointment_1","recordStart_1","recordEnd_1","obj","filterList","collection","val","concat","splice","eventsList_1","event_4","record_1","appLevel","getSmallestMissingNumber","length1","length2","eleGuid","apps","right","dateHeader","DATE_HEADER_WRAP_CLASS","enableAllDayScroll","ALLDAY_APPOINTMENT_AUTO","allDayExpandScroll","scrollTop","ALLDAY_APPOINTMENT_SCROLL","animate","EVENT_COUNT_CLASS","moreEventCount","APPOINTMENT_ROW_EXPAND_CLASS","APPOINTMENT_ROW_COLLAPSE_CLASS","getEventHeight","eventElement","styles","eventWrapper","target","rowHeight","destroy","isDestroyed","removeEventListener"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { append, createElement, extend, EventHandler, prepend, Animation, formatUnit } from '@syncfusion/ej2-base';\r\nimport { isNullOrUndefined, setStyleAttribute, remove, removeClass, addClass } from '@syncfusion/ej2-base';\r\nimport { EventBase } from './event-base';\r\nimport * as util from '../base/util';\r\nimport * as events from '../base/constant';\r\nimport * as cls from '../base/css-constant';\r\n/**\r\n * Vertical view appointment rendering\r\n */\r\nvar VerticalEvent = /** @class */ (function (_super) {\r\n    __extends(VerticalEvent, _super);\r\n    function VerticalEvent(parent) {\r\n        var _this = _super.call(this, parent) || this;\r\n        _this.dateRender = [];\r\n        _this.renderedEvents = [];\r\n        _this.renderedAllDayEvents = [];\r\n        _this.overlapEvents = [];\r\n        _this.moreEvents = [];\r\n        _this.overlapList = [];\r\n        _this.allDayEvents = [];\r\n        _this.slotCount = _this.parent.activeViewOptions.timeScale.slotCount;\r\n        _this.interval = _this.parent.activeViewOptions.timeScale.interval;\r\n        _this.allDayLevel = 0;\r\n        _this.startHour = _this.parent.activeView.getStartHour();\r\n        _this.endHour = _this.parent.activeView.getEndHour();\r\n        _this.element = _this.parent.activeView.getPanel();\r\n        _this.fields = _this.parent.eventFields;\r\n        _this.animation = new Animation({ progress: _this.animationUiUpdate.bind(_this) });\r\n        _this.addEventListener();\r\n        return _this;\r\n    }\r\n    VerticalEvent.prototype.renderAppointments = function () {\r\n        if (isNullOrUndefined(this.parent)) {\r\n            return;\r\n        }\r\n        if (this.parent.dragAndDropModule) {\r\n            this.parent.dragAndDropModule.setDragArea();\r\n        }\r\n        var wrapperElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS +\r\n            ',.' + cls.APPOINTMENT_CLASS + ',.' + cls.ROW_COUNT_WRAPPER_CLASS));\r\n        var isDragging = (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) ? true : false;\r\n        for (var _i = 0, wrapperElements_1 = wrapperElements; _i < wrapperElements_1.length; _i++) {\r\n            var wrapper = wrapperElements_1[_i];\r\n            if (isDragging && !(wrapper.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ||\r\n                wrapper.classList.contains(cls.ROW_COUNT_WRAPPER_CLASS))) {\r\n                var groupIndex = parseInt(wrapper.getAttribute('data-group-index'), 10);\r\n                for (var j = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; j < len; j++) {\r\n                    if (groupIndex === this.parent.crudModule.crudObj.sourceEvent[j].groupIndex ||\r\n                        groupIndex === this.parent.crudModule.crudObj.targetEvent[j].groupIndex) {\r\n                        remove(wrapper);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                remove(wrapper);\r\n            }\r\n        }\r\n        if (!this.element.querySelector('.' + cls.WORK_CELLS_CLASS)) {\r\n            return;\r\n        }\r\n        this.allDayElement = [].slice.call(this.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS));\r\n        this.setAllDayRowHeight(0);\r\n        if (this.parent.eventsProcessed.length === 0 && this.parent.blockProcessed.length === 0) {\r\n            return;\r\n        }\r\n        var expandCollapse = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_SECTION_CLASS);\r\n        EventHandler.remove(expandCollapse, 'click', this.rowExpandCollapse);\r\n        EventHandler.add(expandCollapse, 'click', this.rowExpandCollapse, this);\r\n        this.renderedEvents = [];\r\n        this.renderedAllDayEvents = [];\r\n        this.initializeValues();\r\n        this.processBlockEvents();\r\n        this.renderEvents('normalEvents');\r\n        if (this.allDayEvents.length > 0) {\r\n            this.allDayEvents = this.allDayEvents.filter(function (item, index, arr) {\r\n                return index === arr.map(function (item) { return item.Guid; }).indexOf(item.Guid);\r\n            });\r\n            removeClass(this.allDayElement, cls.ALLDAY_ROW_ANIMATE_CLASS);\r\n            this.slots.push(this.parent.activeView.renderDates.map(function (date) { return +date; }));\r\n            this.renderEvents('allDayEvents');\r\n        }\r\n        this.parent.notify(events.contentReady, {});\r\n        addClass(this.allDayElement, cls.ALLDAY_ROW_ANIMATE_CLASS);\r\n        if (isDragging) {\r\n            this.parent.crudModule.crudObj.isCrudAction = false;\r\n        }\r\n        this.parent.renderTemplates();\r\n    };\r\n    VerticalEvent.prototype.initializeValues = function () {\r\n        this.resources = (this.parent.activeViewOptions.group.resources.length > 0) ? this.parent.uiStateValues.isGroupAdaptive ?\r\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\r\n            this.parent.resourceBase.lastResourceLevel : [];\r\n        this.cellHeight =\r\n            parseFloat(this.parent.element.querySelector('.e-content-wrap tbody tr').getBoundingClientRect().height.toFixed(2));\r\n        this.dateRender[0] = this.parent.activeView.renderDates;\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            for (var i = 0, len = this.resources.length; i < len; i++) {\r\n                this.dateRender[i] = this.resources[i].renderDates;\r\n            }\r\n        }\r\n    };\r\n    VerticalEvent.prototype.getHeight = function (start, end) {\r\n        var appHeight = (util.getUniversalTime(end) - util.getUniversalTime(start)) /\r\n            util.MS_PER_MINUTE * (this.cellHeight * this.slotCount) / this.interval;\r\n        appHeight = (appHeight <= 0) ? this.cellHeight : appHeight;\r\n        return appHeight;\r\n    };\r\n    VerticalEvent.prototype.appendEvent = function (eventObj, appointmentElement, index, appLeft) {\r\n        var appointmentWrap = [].slice.call(this.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\r\n        if (this.parent.enableRtl) {\r\n            setStyleAttribute(appointmentElement, { 'right': appLeft });\r\n        }\r\n        else {\r\n            setStyleAttribute(appointmentElement, { 'left': appLeft });\r\n        }\r\n        var eventType = appointmentElement.classList.contains(cls.BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\r\n        var args = {\r\n            data: extend({}, eventObj, null, true),\r\n            element: appointmentElement, cancel: false, type: eventType\r\n        };\r\n        this.parent.trigger(events.eventRendered, args, function (eventArgs) {\r\n            if (!eventArgs.cancel) {\r\n                appointmentWrap[index].appendChild(appointmentElement);\r\n            }\r\n        });\r\n    };\r\n    VerticalEvent.prototype.processBlockEvents = function () {\r\n        var resources = this.getResourceList();\r\n        var dateCount = 0;\r\n        for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\r\n            var resource = resources_1[_i];\r\n            var renderDates = this.dateRender[resource];\r\n            for (var day = 0, length_1 = renderDates.length; day < length_1; day++) {\r\n                var startDate = new Date(renderDates[day].getTime());\r\n                var endDate = util.addDays(renderDates[day], 1);\r\n                var filterEvents = this.filterEvents(startDate, endDate, this.parent.blockProcessed, this.resources[resource]);\r\n                for (var _a = 0, filterEvents_1 = filterEvents; _a < filterEvents_1.length; _a++) {\r\n                    var event_1 = filterEvents_1[_a];\r\n                    if (this.parent.resourceBase) {\r\n                        this.setValues(event_1, resource);\r\n                    }\r\n                    this.renderBlockEvents(event_1, day, resource, dateCount);\r\n                    this.cssClass = null;\r\n                    this.groupOrder = null;\r\n                }\r\n                dateCount += 1;\r\n            }\r\n        }\r\n    };\r\n    VerticalEvent.prototype.renderBlockEvents = function (eventObj, dayIndex, resource, dayCount) {\r\n        var spannedData = this.isSpannedEvent(eventObj, dayIndex, resource);\r\n        var eStart = spannedData[this.fields.startTime];\r\n        var eEnd = spannedData[this.fields.endTime];\r\n        var currentDate = util.resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\r\n        var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\r\n        if (eStart <= eEnd && this.isValidEvent(eventObj, eStart, eEnd, schedule)) {\r\n            var blockTop = void 0;\r\n            var blockHeight = void 0;\r\n            if (spannedData[this.fields.isAllDay]) {\r\n                var contentWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\r\n                blockHeight = formatUnit(contentWrap.offsetHeight);\r\n                blockTop = formatUnit(0);\r\n            }\r\n            else {\r\n                blockHeight = formatUnit(this.getHeight(eStart, eEnd));\r\n                blockTop = formatUnit(this.getTopValue(eStart, dayIndex, resource));\r\n            }\r\n            var appointmentElement = this.createBlockAppointmentElement(eventObj, resource);\r\n            setStyleAttribute(appointmentElement, { 'width': '100%', 'height': blockHeight, 'top': blockTop });\r\n            var index = this.parent.activeViewOptions.group.byDate ? (this.resources.length * dayIndex) + resource : dayCount;\r\n            this.appendEvent(eventObj, appointmentElement, index, '0px');\r\n        }\r\n    };\r\n    VerticalEvent.prototype.renderEvents = function (eventType) {\r\n        removeClass(this.allDayElement, cls.ALLDAY_ROW_ANIMATE_CLASS);\r\n        var eventCollection = (eventType === 'allDayEvents') ? this.sortByDateTime(this.allDayEvents) : undefined;\r\n        var resources = this.getResourceList();\r\n        var dateCount = 0;\r\n        var isRender;\r\n        var _loop_1 = function (resource) {\r\n            isRender = true;\r\n            if (this_1.parent.crudModule && this_1.parent.crudModule.crudObj.isCrudAction && eventType !== 'allDayEvents'\r\n                && !this_1.parent.uiStateValues.isGroupAdaptive) {\r\n                if (this_1.parent.crudModule.crudObj.sourceEvent.filter(function (data) { return data.groupIndex === resource; }).length === 0 &&\r\n                    this_1.parent.crudModule.crudObj.targetEvent.filter(function (data) { return data.groupIndex === resource; }).length === 0) {\r\n                    isRender = false;\r\n                }\r\n            }\r\n            this_1.slots = [];\r\n            var renderDates = this_1.dateRender[resource];\r\n            var renderedDate = this_1.getRenderedDates(renderDates) || renderDates;\r\n            this_1.slots.push(renderDates.map(function (date) { return +date; }));\r\n            for (var day = 0, length_2 = renderDates.length; day < length_2 &&\r\n                renderDates[day] <= renderedDate[renderedDate.length - 1]; day++) {\r\n                this_1.renderedEvents = [];\r\n                var startDate = new Date(renderDates[day].getTime());\r\n                var endDate = util.addDays(renderDates[day], 1);\r\n                var filterEvents = this_1.filterEvents(startDate, endDate, eventCollection, this_1.resources[resource]);\r\n                if (isRender) {\r\n                    for (var _i = 0, filterEvents_2 = filterEvents; _i < filterEvents_2.length; _i++) {\r\n                        var event_2 = filterEvents_2[_i];\r\n                        if (this_1.parent.resourceBase) {\r\n                            this_1.setValues(event_2, resource);\r\n                        }\r\n                        if (eventType === 'allDayEvents') {\r\n                            this_1.renderAllDayEvents(event_2, day, resource, dateCount);\r\n                        }\r\n                        else {\r\n                            if (this_1.isAllDayAppointment(event_2)) {\r\n                                this_1.allDayEvents.push(extend({}, event_2, null, true));\r\n                            }\r\n                            else {\r\n                                if (this_1.parent.eventSettings.enableMaxHeight) {\r\n                                    if (this_1.getOverlapIndex(event_2, day, false, resource) > 0) {\r\n                                        continue;\r\n                                    }\r\n                                }\r\n                                this_1.renderNormalEvents(event_2, day, resource, dateCount);\r\n                            }\r\n                        }\r\n                        this_1.cssClass = null;\r\n                        this_1.groupOrder = null;\r\n                    }\r\n                }\r\n                else {\r\n                    for (var _a = 0, filterEvents_3 = filterEvents; _a < filterEvents_3.length; _a++) {\r\n                        var event_3 = filterEvents_3[_a];\r\n                        if (this_1.isAllDayAppointment(event_3)) {\r\n                            this_1.allDayEvents.push(extend({}, event_3, null, true));\r\n                        }\r\n                    }\r\n                }\r\n                dateCount += 1;\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        for (var _i = 0, resources_2 = resources; _i < resources_2.length; _i++) {\r\n            var resource = resources_2[_i];\r\n            _loop_1(resource);\r\n        }\r\n    };\r\n    VerticalEvent.prototype.setValues = function (event, resourceIndex) {\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            this.cssClass = this.resources[resourceIndex].cssClass;\r\n            this.groupOrder = this.resources[resourceIndex].groupOrder;\r\n        }\r\n        else {\r\n            this.cssClass = this.parent.resourceBase.getCssClass(event);\r\n        }\r\n    };\r\n    VerticalEvent.prototype.getResourceList = function () {\r\n        // eslint-disable-next-line prefer-spread\r\n        var resources = Array.apply(null, {\r\n            length: (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) ?\r\n                this.resources.length : 1\r\n        }).map(function (value, index) { return index; });\r\n        return resources;\r\n    };\r\n    // eslint-disable-next-line max-len\r\n    VerticalEvent.prototype.createAppointmentElement = function (record, isAllDay, data, resource) {\r\n        var fieldMapping = this.parent.eventFields;\r\n        var recordSubject = (record[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default\r\n            || this.parent.localeObj.getConstant('addTitle'));\r\n        var appointmentWrapper = createElement('div', {\r\n            className: cls.APPOINTMENT_CLASS,\r\n            attrs: {\r\n                'data-id': 'Appointment_' + record[fieldMapping.id],\r\n                'data-guid': record.Guid,\r\n                'role': 'button',\r\n                'tabindex': '0',\r\n                'aria-readonly': this.parent.eventBase.getReadonlyAttribute(record),\r\n                'aria-selected': 'false',\r\n                'aria-grabbed': 'true',\r\n                'aria-label': this.parent.getAnnouncementString(record)\r\n            }\r\n        });\r\n        if (record[this.fields.isReadonly]) {\r\n            addClass([appointmentWrapper], 'e-read-only');\r\n        }\r\n        var appointmentDetails = createElement('div', { className: cls.APPOINTMENT_DETAILS });\r\n        appointmentWrapper.appendChild(appointmentDetails);\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            var resourceIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : resource;\r\n            appointmentWrapper.setAttribute('data-group-index', resourceIndex.toString());\r\n        }\r\n        var templateElement;\r\n        var eventData = data;\r\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\r\n            var elementId = this.parent.element.id + '_';\r\n            var viewName = this.parent.activeViewOptions.eventTemplateName;\r\n            var templateId = elementId + viewName + 'eventTemplate';\r\n            templateElement = this.parent.getAppointmentTemplate()(record, this.parent, 'eventTemplate', templateId, false);\r\n        }\r\n        else {\r\n            var appointmentSubject = createElement('div', { className: cls.SUBJECT_CLASS, innerHTML: recordSubject });\r\n            if (isAllDay) {\r\n                if (record[fieldMapping.isAllDay]) {\r\n                    templateElement = [appointmentSubject];\r\n                }\r\n                else {\r\n                    templateElement = [];\r\n                    var appointmentStartTime = createElement('div', {\r\n                        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\r\n                        innerHTML: this.parent.getTimeString(record[fieldMapping.startTime])\r\n                    });\r\n                    var appointmentEndTime = createElement('div', {\r\n                        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\r\n                        innerHTML: this.parent.getTimeString(record[fieldMapping.endTime])\r\n                    });\r\n                    addClass([appointmentSubject], 'e-text-center');\r\n                    if (!eventData.isLeft) {\r\n                        templateElement.push(appointmentStartTime);\r\n                    }\r\n                    templateElement.push(appointmentSubject);\r\n                    if (!eventData.isRight) {\r\n                        templateElement.push(appointmentEndTime);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                var timeStr = this.parent.getTimeString(record[fieldMapping.startTime]) + ' - ' +\r\n                    this.parent.getTimeString(record[fieldMapping.endTime]);\r\n                var appointmentTime = createElement('div', {\r\n                    className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\r\n                    innerHTML: timeStr\r\n                });\r\n                var appointmentLocation = createElement('div', {\r\n                    className: cls.LOCATION_CLASS,\r\n                    innerHTML: (record[fieldMapping.location] || this.parent.eventSettings.fields.location.default || '')\r\n                });\r\n                templateElement = [appointmentSubject, appointmentTime, appointmentLocation];\r\n            }\r\n        }\r\n        append(templateElement, appointmentDetails);\r\n        if (!this.parent.isAdaptive &&\r\n            (!isNullOrUndefined(record[fieldMapping.recurrenceRule]) || !isNullOrUndefined(record[fieldMapping.recurrenceID]))) {\r\n            var iconClass = (record[fieldMapping.id] === record[fieldMapping.recurrenceID]) ?\r\n                cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\r\n            var recurrenceIcon = createElement('div', { className: cls.ICON + ' ' + iconClass });\r\n            if (isAllDay) {\r\n                appointmentDetails.appendChild(recurrenceIcon);\r\n            }\r\n            else {\r\n                appointmentWrapper.appendChild(recurrenceIcon);\r\n            }\r\n        }\r\n        this.renderSpannedIcon(isAllDay ? appointmentDetails : appointmentWrapper, eventData);\r\n        if (!isNullOrUndefined(this.cssClass)) {\r\n            addClass([appointmentWrapper], this.cssClass);\r\n        }\r\n        this.applyResourceColor(appointmentWrapper, record, 'backgroundColor', this.groupOrder);\r\n        this.renderResizeHandler(appointmentWrapper, eventData, record[this.fields.isReadonly]);\r\n        return appointmentWrapper;\r\n    };\r\n    VerticalEvent.prototype.createMoreIndicator = function (allDayRow, count, currentDay) {\r\n        var index = currentDay + count;\r\n        var countWrapper = allDayRow[index];\r\n        if (countWrapper.childElementCount <= 0) {\r\n            var innerCountWrap = createElement('div', {\r\n                className: cls.ROW_COUNT_WRAPPER_CLASS,\r\n                id: cls.ROW_COUNT_WRAPPER_CLASS + '-' + index.toString()\r\n            });\r\n            var moreIndicatorElement = createElement('div', {\r\n                className: cls.MORE_INDICATOR_CLASS,\r\n                attrs: { 'tabindex': '0', 'role': 'list', 'data-index': index.toString(), 'data-count': '1' },\r\n                innerHTML: '+1&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'))\r\n            });\r\n            innerCountWrap.appendChild(moreIndicatorElement);\r\n            countWrapper.appendChild(innerCountWrap);\r\n            EventHandler.add(moreIndicatorElement, 'click', this.rowExpandCollapse, this);\r\n        }\r\n        else {\r\n            var countCell = countWrapper.querySelector('.' + cls.MORE_INDICATOR_CLASS);\r\n            var moreCount = parseInt(countCell.getAttribute('data-count'), 10) + 1;\r\n            countCell.setAttribute('data-count', moreCount.toString());\r\n            countCell.innerHTML = '+' + this.parent.globalize.formatNumber(moreCount) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\r\n        }\r\n    };\r\n    VerticalEvent.prototype.renderSpannedIcon = function (element, spanEvent) {\r\n        var iconElement = createElement('div', { className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON });\r\n        if (spanEvent.isLeft) {\r\n            var iconLeft = iconElement.cloneNode();\r\n            addClass([iconLeft], cls.EVENT_ICON_LEFT_CLASS);\r\n            prepend([iconLeft], element);\r\n        }\r\n        if (spanEvent.isRight) {\r\n            var iconRight = iconElement.cloneNode();\r\n            addClass([iconRight], cls.EVENT_ICON_RIGHT_CLASS);\r\n            append([iconRight], element);\r\n        }\r\n        if (spanEvent.isTop) {\r\n            var iconTop = iconElement.cloneNode();\r\n            addClass([iconTop], cls.EVENT_ICON_UP_CLASS);\r\n            prepend([iconTop], element);\r\n        }\r\n        if (spanEvent.isBottom) {\r\n            var iconBottom = iconElement.cloneNode();\r\n            addClass([iconBottom], cls.EVENT_ICON_DOWN_CLASS);\r\n            append([iconBottom], element);\r\n        }\r\n    };\r\n    VerticalEvent.prototype.isSpannedEvent = function (record, day, resource) {\r\n        var currentDate = util.resetTime(this.dateRender[resource][day]);\r\n        var renderedDate = this.getRenderedDates(this.dateRender[resource]) || [currentDate];\r\n        var currentDay = renderedDate.filter(function (date) { return date.getDay() === day; });\r\n        if (currentDay.length === 0) {\r\n            currentDate = util.resetTime(renderedDate[0]);\r\n        }\r\n        var field = this.parent.eventFields;\r\n        var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\r\n        var event = extend({}, record, null, true);\r\n        event.isSpanned = { isBottom: false, isTop: false };\r\n        if (record[field.startTime].getTime() < schedule.startHour.getTime()) {\r\n            event[field.startTime] = schedule.startHour;\r\n            event.isSpanned.isTop = true;\r\n        }\r\n        if (record[field.endTime].getTime() > schedule.endHour.getTime()) {\r\n            event[field.endTime] = schedule.endHour;\r\n            event.isSpanned.isBottom = true;\r\n        }\r\n        var eventDates = this.updateEventMinimumDuration(schedule, event[field.startTime], event[field.endTime]);\r\n        event[field.startTime] = eventDates.startDate;\r\n        event[field.endTime] = eventDates.endDate;\r\n        return event;\r\n    };\r\n    VerticalEvent.prototype.renderAllDayEvents = function (eventObj, dayIndex, resource, dayCount, inline) {\r\n        var _this = this;\r\n        var currentDates = this.getRenderedDates(this.dateRender[resource]) || this.dateRender[resource];\r\n        if (this.parent.activeViewOptions.group.byDate) {\r\n            this.slots[0] = [this.dateRender[resource][dayIndex].getTime()];\r\n            currentDates = [this.dateRender[resource][dayIndex]];\r\n        }\r\n        var record = this.splitEvent(eventObj, currentDates)[0];\r\n        var allDayRowCell = this.element.querySelector('.' + cls.ALLDAY_CELLS_CLASS + ':first-child');\r\n        var cellTop = allDayRowCell.offsetTop;\r\n        var eStart = new Date(record[this.parent.eventFields.startTime].getTime());\r\n        var eEnd = new Date(record[this.parent.eventFields.endTime].getTime());\r\n        var appWidth = 0;\r\n        var topValue = 1;\r\n        var isDateRange = currentDates[0].getTime() <= eStart.getTime() &&\r\n            util.addDays(currentDates.slice(-1)[0], 1).getTime() >= eStart.getTime();\r\n        if (eStart <= eEnd && isDateRange) {\r\n            var isAlreadyRendered = [];\r\n            if (this.renderedAllDayEvents[resource]) {\r\n                isAlreadyRendered = this.renderedAllDayEvents[resource].filter(function (event) {\r\n                    return event.Guid === eventObj.Guid;\r\n                });\r\n                if (this.parent.activeViewOptions.group.byDate) {\r\n                    isAlreadyRendered = isAlreadyRendered.filter(function (event) {\r\n                        return event[_this.parent.eventFields.startTime] >= currentDates[dayIndex] &&\r\n                            event[_this.parent.eventFields.endTime] <= util.addDays(new Date(+currentDates[dayIndex]), 1);\r\n                    });\r\n                }\r\n            }\r\n            if (isAlreadyRendered.length === 0) {\r\n                var allDayDifference_1 = record.data.count;\r\n                var allDayIndex_1 = this.getOverlapIndex(record, dayIndex, true, resource);\r\n                record.Index = allDayIndex_1;\r\n                this.allDayLevel = (this.allDayLevel < allDayIndex_1) ? allDayIndex_1 : this.allDayLevel;\r\n                var widthAdjustment = record.data.isRight ? 0 :\r\n                    this.parent.currentView === 'Day' ? 4 : 7;\r\n                if (allDayDifference_1 >= 0) {\r\n                    appWidth = (allDayDifference_1 * 100) - widthAdjustment;\r\n                }\r\n                if (isNullOrUndefined(this.renderedAllDayEvents[resource])) {\r\n                    this.renderedAllDayEvents[resource] = [];\r\n                }\r\n                this.renderedAllDayEvents[resource].push(extend({}, record, null, true));\r\n                var allDayRow_1 = [].slice.call(this.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).children);\r\n                var wIndex_1 = this.parent.activeViewOptions.group.byDate ?\r\n                    (this.resources.length * dayIndex) + resource : dayCount;\r\n                var eventWrapper_1 = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS +\r\n                    ':nth-child(' + (wIndex_1 + 1) + ')');\r\n                var appointmentElement_1;\r\n                if (inline) {\r\n                    appointmentElement_1 = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\r\n                }\r\n                else {\r\n                    appointmentElement_1 = this.createAppointmentElement(eventObj, true, record.data, resource);\r\n                }\r\n                addClass([appointmentElement_1], cls.ALLDAY_APPOINTMENT_CLASS);\r\n                var args = { data: eventObj, element: appointmentElement_1, cancel: false };\r\n                this.parent.trigger(events.eventRendered, args, function (eventArgs) {\r\n                    if (!eventArgs.cancel) {\r\n                        eventWrapper_1.appendChild(appointmentElement_1);\r\n                        var appHeight = appointmentElement_1.offsetHeight;\r\n                        topValue += (allDayIndex_1 === 0 ? cellTop : (cellTop + (allDayIndex_1 * appHeight))) + 1;\r\n                        setStyleAttribute(appointmentElement_1, { 'width': appWidth + '%', 'top': formatUnit(topValue) });\r\n                        if (allDayIndex_1 > 1) {\r\n                            _this.moreEvents.push(appointmentElement_1);\r\n                            for (var count = 0, length_3 = allDayDifference_1; count < length_3; count++) {\r\n                                _this.createMoreIndicator(allDayRow_1, count, wIndex_1);\r\n                            }\r\n                        }\r\n                        allDayRowCell.setAttribute('data-count', _this.allDayLevel.toString());\r\n                        var allDayRowHeight = ((!_this.parent.uiStateValues.expand && _this.allDayLevel > 2) ?\r\n                            (3 * appHeight) : ((_this.allDayLevel + 1) * appHeight)) + 4;\r\n                        _this.setAllDayRowHeight(allDayRowHeight);\r\n                        _this.addOrRemoveClass();\r\n                        _this.wireAppointmentEvents(appointmentElement_1, eventObj);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n    VerticalEvent.prototype.renderNormalEvents = function (eventObj, dayIndex, resource, dayCount, inline) {\r\n        var record = this.isSpannedEvent(eventObj, dayIndex, resource);\r\n        var eStart = record[this.fields.startTime];\r\n        var eEnd = record[this.fields.endTime];\r\n        var appWidth = '0%';\r\n        var appLeft = '0%';\r\n        var topValue = 0;\r\n        var currentDate = util.resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\r\n        var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\r\n        var isValidEvent = this.isValidEvent(eventObj, eStart, eEnd, schedule);\r\n        if (eStart <= eEnd && isValidEvent) {\r\n            var appHeight_1 = this.getHeight(eStart, eEnd);\r\n            if (eStart.getTime() > schedule.startHour.getTime()) {\r\n                topValue = this.getTopValue(eStart, dayIndex, resource);\r\n            }\r\n            var appIndex = this.getOverlapIndex(record, dayIndex, false, resource);\r\n            record.Index = appIndex;\r\n            this.overlapList.push(record);\r\n            if (this.overlapList.length > 1) {\r\n                if (isNullOrUndefined(this.overlapEvents[appIndex])) {\r\n                    this.overlapEvents[appIndex] = [];\r\n                }\r\n                this.overlapEvents[appIndex].push(record);\r\n            }\r\n            else {\r\n                this.overlapEvents = [];\r\n                this.overlapEvents.push([record]);\r\n            }\r\n            appWidth = this.getEventWidth();\r\n            var argsData = {\r\n                index: appIndex, left: appLeft, width: appWidth,\r\n                day: dayIndex, dayIndex: dayCount, record: record, resource: resource\r\n            };\r\n            var tempData = this.adjustOverlapElements(argsData);\r\n            appWidth = (tempData.appWidth);\r\n            if (isNullOrUndefined(this.renderedEvents[resource])) {\r\n                this.renderedEvents[resource] = [];\r\n            }\r\n            this.renderedEvents[resource].push(extend({}, record, null, true));\r\n            var appointmentElement = void 0;\r\n            if (inline) {\r\n                appointmentElement = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\r\n            }\r\n            else {\r\n                appointmentElement = this.createAppointmentElement(eventObj, false, record.isSpanned, resource);\r\n            }\r\n            setStyleAttribute(appointmentElement, {\r\n                'width': (this.parent.eventSettings.enableMaxHeight ? '100%' : tempData.appWidth),\r\n                'height': appHeight_1 + 'px', 'top': topValue + 'px'\r\n            });\r\n            var iconHeight = appointmentElement.querySelectorAll('.' + cls.EVENT_INDICATOR_CLASS).length * 15;\r\n            var maxHeight = appHeight_1 - 40 - iconHeight;\r\n            var subjectElement = appointmentElement.querySelector('.' + cls.SUBJECT_CLASS);\r\n            if (!this.parent.isAdaptive && subjectElement) {\r\n                subjectElement.style.maxHeight = formatUnit(maxHeight);\r\n            }\r\n            var index = this.parent.activeViewOptions.group.byDate ? (this.resources.length * dayIndex) + resource : dayCount;\r\n            this.appendEvent(eventObj, appointmentElement, index, tempData.appLeft);\r\n            this.wireAppointmentEvents(appointmentElement, eventObj);\r\n            if (appHeight_1 < this.cellHeight) {\r\n                var resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + cls.EVENT_RESIZE_CLASS));\r\n                resizeHandlers.forEach(function (resizeHandler) {\r\n                    resizeHandler.style.height = Math.ceil(appHeight_1 / resizeHandler.offsetHeight) + 'px';\r\n                });\r\n            }\r\n        }\r\n    };\r\n    VerticalEvent.prototype.getEventWidth = function () {\r\n        var width = this.parent.currentView === 'Day' ? 97 : 94;\r\n        var tempWidth = ((width - this.overlapEvents.length) / this.overlapEvents.length);\r\n        return (tempWidth < 0 ? 0 : tempWidth) + '%';\r\n    };\r\n    VerticalEvent.prototype.getEventLeft = function (appWidth, index) {\r\n        var tempLeft = (parseFloat(appWidth) + 1) * index;\r\n        return (tempLeft > 99 ? 99 : tempLeft) + '%';\r\n    };\r\n    VerticalEvent.prototype.getTopValue = function (date, day, resource) {\r\n        var startEndHours = util.getStartEndHours(util.resetTime(this.dateRender[resource][day]), this.startHour, this.endHour);\r\n        var startHour = startEndHours.startHour;\r\n        var diffInMinutes = ((date.getHours() - startHour.getHours()) * 60) + (date.getMinutes() - startHour.getMinutes());\r\n        return (this.parent.activeViewOptions.timeScale.enable) ? ((diffInMinutes * this.cellHeight * this.slotCount) / this.interval) : 0;\r\n    };\r\n    VerticalEvent.prototype.getOverlapIndex = function (record, day, isAllDay, resource) {\r\n        var _this = this;\r\n        var fieldMapping = this.parent.eventFields;\r\n        var eventsList = [];\r\n        var appIndex = -1;\r\n        this.overlapEvents = [];\r\n        if (isAllDay) {\r\n            if (!isNullOrUndefined(this.renderedAllDayEvents[resource])) {\r\n                var date_1 = util.resetTime(new Date(this.dateRender[resource][day].getTime()));\r\n                eventsList = this.renderedAllDayEvents[resource].filter(function (app) {\r\n                    return util.resetTime(app[fieldMapping.startTime]).getTime() <= date_1.getTime() &&\r\n                        util.resetTime(app[fieldMapping.endTime]).getTime() >= date_1.getTime();\r\n                });\r\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n                    eventsList = this.filterEventsByResource(this.resources[resource], eventsList);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            var appointmentList_1 = !isNullOrUndefined(this.renderedEvents[resource]) ?\r\n                this.renderedEvents[resource] : [];\r\n            var appointment_1 = [];\r\n            var recordStart_1 = record[fieldMapping.startTime];\r\n            var recordEnd_1 = record[fieldMapping.endTime];\r\n            this.overlapList = appointmentList_1.filter(function (data) {\r\n                return (data[fieldMapping.endTime] > recordStart_1 && data[fieldMapping.startTime] <= recordEnd_1) ||\r\n                    (data[fieldMapping.startTime] >= recordEnd_1 && data[fieldMapping.endTime] <= recordStart_1) ||\r\n                    (data[fieldMapping.endTime].getTime() === data[fieldMapping.startTime].getTime() &&\r\n                        data[fieldMapping.startTime].getTime() === recordStart_1.getTime() && data[fieldMapping.endTime] < recordEnd_1);\r\n            });\r\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n                this.overlapList = this.filterEventsByResource(this.resources[resource], this.overlapList);\r\n            }\r\n            this.overlapList.forEach(function (obj) {\r\n                var filterList = appointmentList_1.filter(function (data) {\r\n                    return data[fieldMapping.endTime] > obj[fieldMapping.startTime] && data[fieldMapping.startTime] <= obj[fieldMapping.endTime];\r\n                });\r\n                if (_this.parent.activeViewOptions.group.resources.length > 0) {\r\n                    filterList = _this.filterEventsByResource(_this.resources[resource], filterList);\r\n                }\r\n                var collection = filterList.filter(function (val) {\r\n                    return _this.overlapList.indexOf(val) === -1;\r\n                });\r\n                if (collection.length > 0) {\r\n                    appointment_1 = appointment_1.concat(collection);\r\n                }\r\n            });\r\n            for (var i = 0; i < appointment_1.length - 1; i++) {\r\n                for (var j = i + 1; j < appointment_1.length; j++) {\r\n                    if (appointment_1[i][fieldMapping.id] === appointment_1[j][fieldMapping.id]) {\r\n                        appointment_1.splice(j, 1);\r\n                        j--;\r\n                    }\r\n                }\r\n            }\r\n            this.overlapList = this.overlapList.concat(appointment_1);\r\n            eventsList = this.overlapList;\r\n            for (var _i = 0, eventsList_1 = eventsList; _i < eventsList_1.length; _i++) {\r\n                var event_4 = eventsList_1[_i];\r\n                var record_1 = event_4;\r\n                var index = record_1.Index;\r\n                if (isNullOrUndefined(this.overlapEvents[index])) {\r\n                    this.overlapEvents[index] = [event_4];\r\n                }\r\n                else {\r\n                    this.overlapEvents[index].push(event_4);\r\n                }\r\n            }\r\n        }\r\n        if (!isAllDay) {\r\n            eventsList = eventsList.filter(function (obj) { return (obj[fieldMapping.startTime] === record[fieldMapping.startTime] &&\r\n                obj[fieldMapping.endTime] > record[fieldMapping.endTime] || obj[fieldMapping.endTime] > record[fieldMapping.startTime] &&\r\n                obj[fieldMapping.startTime] < record[fieldMapping.endTime] || obj[fieldMapping.endTime] === record[fieldMapping.startTime]\r\n                && obj[fieldMapping.startTime] === record[fieldMapping.endTime]) ||\r\n                ((obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() &&\r\n                    obj[fieldMapping.endTime].getTime() === record[fieldMapping.endTime].getTime())\r\n                    || (obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() &&\r\n                        obj[fieldMapping.endTime].getTime() < record[fieldMapping.endTime].getTime() ||\r\n                        obj[fieldMapping.endTime].getTime() > record[fieldMapping.endTime].getTime())); });\r\n        }\r\n        if (eventsList.length > 0) {\r\n            var appLevel = eventsList.map(function (obj) { return obj.Index; });\r\n            appIndex = (appLevel.length > 0) ? this.getSmallestMissingNumber(appLevel) : 0;\r\n        }\r\n        return (appIndex === -1) ? 0 : appIndex;\r\n    };\r\n    VerticalEvent.prototype.adjustOverlapElements = function (args) {\r\n        var data = { appWidth: args.width, appLeft: args.left };\r\n        for (var i = 0, length1 = this.overlapEvents.length; i < length1; i++) {\r\n            if (!isNullOrUndefined(this.overlapEvents[i])) {\r\n                for (var j = 0, length2 = this.overlapEvents[i].length; j < length2; j++) {\r\n                    var dayCount = this.parent.activeViewOptions.group.byDate ?\r\n                        (this.resources.length * args.day) + args.resource : args.dayIndex;\r\n                    var element = this.element.querySelector('#e-appointment-wrapper-' + dayCount);\r\n                    if (element.childElementCount > 0) {\r\n                        var eleGuid = this.overlapEvents[i][j].Guid;\r\n                        if (element.querySelectorAll('div[data-guid=\"' + eleGuid + '\"]').length > 0 && eleGuid !== args.record.Guid) {\r\n                            var apps = element.querySelector('div[data-guid=\"' + eleGuid + '\"]');\r\n                            if (parseFloat(args.width) <= parseFloat(apps.style.width)) {\r\n                                if (this.parent.enableRtl) {\r\n                                    apps.style.right = this.getEventLeft(args.width, i);\r\n                                }\r\n                                else {\r\n                                    apps.style.left = this.getEventLeft(args.width, i);\r\n                                }\r\n                                apps.style.width = ((parseFloat(args.width))) + '%';\r\n                                data.appWidth = apps.style.width;\r\n                            }\r\n                            else {\r\n                                data.appWidth = apps.style.width;\r\n                            }\r\n                        }\r\n                        else {\r\n                            var appWidth = args.width;\r\n                            if (isNullOrUndefined(this.overlapEvents[i - 1])) {\r\n                                appWidth = this.getEventWidth();\r\n                            }\r\n                            data.appWidth = appWidth;\r\n                            data.appLeft = this.getEventLeft(appWidth, args.index);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return data;\r\n    };\r\n    VerticalEvent.prototype.setAllDayRowHeight = function (height) {\r\n        var dateHeader = this.parent.element.querySelector('.' + cls.DATE_HEADER_WRAP_CLASS);\r\n        if (this.parent.height === 'auto' || !this.parent.enableAllDayScroll) {\r\n            addClass([dateHeader], cls.ALLDAY_APPOINTMENT_AUTO);\r\n        }\r\n        var allDayRow = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\r\n        allDayRow.style.height = '';\r\n        if (this.parent.uiStateValues.expand && this.parent.height !== 'auto' && this.parent.enableAllDayScroll) {\r\n            allDayRow.style.height = (height / 12) + 'em';\r\n            this.parent.eventBase.allDayExpandScroll(dateHeader);\r\n        }\r\n        else {\r\n            dateHeader.scrollTop = 0;\r\n            for (var _i = 0, _a = this.allDayElement; _i < _a.length; _i++) {\r\n                var element = _a[_i];\r\n                element.style.height = (height / 12) + 'em';\r\n            }\r\n            removeClass([dateHeader], cls.ALLDAY_APPOINTMENT_SCROLL);\r\n        }\r\n        this.animation.animate(this.allDayElement[0]);\r\n    };\r\n    VerticalEvent.prototype.addOrRemoveClass = function () {\r\n        var _this = this;\r\n        this.moreEvents.filter(function (element) {\r\n            if (!_this.parent.uiStateValues.expand && _this.allDayLevel > 2) {\r\n                addClass([element], cls.EVENT_COUNT_CLASS);\r\n                element.setAttribute('tabindex', '-1');\r\n            }\r\n            else {\r\n                removeClass([element], cls.EVENT_COUNT_CLASS);\r\n                element.setAttribute('tabindex', '0');\r\n            }\r\n        });\r\n        var moreEventCount = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_SECTION_CLASS);\r\n        if (this.parent.uiStateValues.expand) {\r\n            removeClass([moreEventCount], cls.APPOINTMENT_ROW_EXPAND_CLASS);\r\n            addClass([moreEventCount], cls.APPOINTMENT_ROW_COLLAPSE_CLASS);\r\n        }\r\n        else {\r\n            removeClass([moreEventCount], cls.APPOINTMENT_ROW_COLLAPSE_CLASS);\r\n            addClass([moreEventCount], cls.APPOINTMENT_ROW_EXPAND_CLASS);\r\n        }\r\n        if (this.allDayLevel > 2) {\r\n            removeClass([moreEventCount], cls.DISABLE_CLASS);\r\n        }\r\n        else {\r\n            addClass([moreEventCount], cls.DISABLE_CLASS);\r\n        }\r\n        var countCell = [].slice.call(this.element.querySelectorAll('.' + cls.ROW_COUNT_WRAPPER_CLASS));\r\n        countCell.forEach(function (element) {\r\n            if (!_this.parent.uiStateValues.expand && _this.allDayLevel > 2) {\r\n                removeClass([element], cls.DISABLE_CLASS);\r\n            }\r\n            else {\r\n                addClass([element], cls.DISABLE_CLASS);\r\n            }\r\n        });\r\n    };\r\n    VerticalEvent.prototype.getEventHeight = function () {\r\n        var eventElement = createElement('div', { className: cls.APPOINTMENT_CLASS, styles: 'visibility:hidden' });\r\n        var eventWrapper = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS + ':first-child');\r\n        eventWrapper.appendChild(eventElement);\r\n        var height = eventElement.offsetHeight;\r\n        remove(eventElement);\r\n        return height;\r\n    };\r\n    VerticalEvent.prototype.rowExpandCollapse = function () {\r\n        var target = this.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_SECTION_CLASS);\r\n        this.parent.uiStateValues.expand = target.classList.contains(cls.APPOINTMENT_ROW_EXPAND_CLASS);\r\n        var rowHeight;\r\n        if (this.parent.uiStateValues.expand) {\r\n            target.setAttribute('title', this.parent.localeObj.getConstant('collapseAllDaySection'));\r\n            target.setAttribute('aria-label', 'Collapse section');\r\n            rowHeight = ((this.allDayLevel + 1) * this.getEventHeight()) + 4;\r\n        }\r\n        else {\r\n            target.setAttribute('title', this.parent.localeObj.getConstant('expandAllDaySection'));\r\n            target.setAttribute('aria-label', 'Expand section');\r\n            rowHeight = (3 * this.getEventHeight()) + 4;\r\n        }\r\n        this.setAllDayRowHeight(rowHeight);\r\n        this.addOrRemoveClass();\r\n        this.animation.animate(target);\r\n    };\r\n    VerticalEvent.prototype.animationUiUpdate = function () {\r\n        this.parent.notify(events.contentReady, {});\r\n    };\r\n    VerticalEvent.prototype.destroy = function () {\r\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\r\n            return;\r\n        }\r\n        this.removeEventListener();\r\n        this.allDayElement = null;\r\n        this.renderedAllDayEvents = null;\r\n        this.renderedEvents = null;\r\n        this.slotCount = null;\r\n        this.interval = null;\r\n        this.startHour = null;\r\n        this.endHour = null;\r\n        this.element = null;\r\n        this.fields = null;\r\n        this.animation = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return VerticalEvent;\r\n}(EventBase));\r\nexport { VerticalEvent };\r\n"]},"metadata":{},"sourceType":"module"}