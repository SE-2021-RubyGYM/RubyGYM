{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\r\n * Schedule events drag actions\r\n */\n\nvar DragAndDrop =\n/** @class */\nfunction (_super) {\n  __extends(DragAndDrop, _super);\n\n  function DragAndDrop() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.widthUptoCursorPoint = 0;\n    _this.heightUptoCursorPoint = 0;\n    _this.cursorPointIndex = 0;\n    _this.isHeaderRows = false;\n    _this.isTimelineDayProcess = false;\n    _this.widthPerMinute = 0;\n    _this.heightPerMinute = 0;\n    _this.minDiff = 0;\n    _this.isStepDragging = false;\n    _this.isMorePopupOpened = false;\n    _this.isAllDayDrag = false;\n    _this.isMultiSelect = false;\n    _this.multiData = [];\n    _this.updatedData = [];\n    _this.swagData = [];\n    _this.startTime = 0;\n    _this.isAllDayTarget = false;\n    _this.targetTd = null;\n    _this.isCursorAhead = false;\n    return _this;\n  }\n\n  DragAndDrop.prototype.wireDragEvent = function (element) {\n    new Draggable(element, {\n      abort: '.' + cls.EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTapHold: this.parent.isAdaptive,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.dragArea,\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n  };\n\n  DragAndDrop.prototype.setDragArea = function () {\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    this.dragArea = this.parent.eventDragArea && dragElement ? dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n  };\n\n  DragAndDrop.prototype.dragHelper = function (e) {\n    var _this = this;\n\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    this.actionObj.action = 'drag';\n    var elements = [];\n\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n\n    elements.forEach(function (ele) {\n      var cloneElement = _this.createCloneElement(ele);\n\n      if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n        _this.actionObj.clone = cloneElement;\n\n        if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' && _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() && !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(_this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n\n        _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n      }\n\n      _this.actionObj.cloneElement.push(cloneElement);\n\n      _this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  };\n\n  DragAndDrop.prototype.dragPosition = function (e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n\n    var cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    var leftValue = formatUnit(0);\n\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n\n    var cloneRight;\n\n    if (this.isStepDragging) {\n      cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n    } else {\n      cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl && this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n      this.isCursorAhead = true;\n    }\n\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n\n    var topValue;\n\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n\n      var top_1 = parseInt(e.top, 10);\n      top_1 = top_1 < 0 ? 0 : top_1;\n      topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n      var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n    }\n\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  };\n\n  DragAndDrop.prototype.setDragActionDefaultValues = function () {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  };\n\n  DragAndDrop.prototype.dragStart = function (e) {\n    var _this = this;\n\n    var eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (!isNullOrUndefined(eventObj)) {\n      this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    }\n\n    var dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel || !isNullOrUndefined(_this.actionObj.element) && isNullOrUndefined(_this.actionObj.element.parentElement)) {\n        var dragObj = _this.actionObj.element.ej2_instances[0];\n\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n\n        _this.actionObj.action = '';\n\n        _this.removeCloneElementClasses();\n\n        _this.removeCloneElement();\n\n        return;\n      }\n\n      _this.actionClass('addClass');\n\n      _this.parent.uiStateValues.action = true;\n      _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n      _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n      _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      _this.actionObj.interval = dragEventArgs.interval;\n      _this.actionObj.navigation = dragEventArgs.navigation;\n      _this.actionObj.scroll = dragEventArgs.scroll;\n      _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n\n      var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      _this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      _this.widthPerMinute = _this.actionObj.cellWidth / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.heightPerMinute = _this.actionObj.cellHeight / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.widthUptoCursorPoint = 0;\n      _this.heightUptoCursorPoint = 0;\n      _this.cursorPointIndex = -1;\n      _this.isHeaderRows = false;\n      _this.isTimelineDayProcess = false;\n      _this.minDiff = 0;\n      _this.isMorePopupOpened = false;\n      _this.daysVariation = -1;\n      _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n\n      if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) && _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n          _this.isMorePopupOpened = true;\n        }\n\n        _this.actionObj.pageX = e.event.pageX;\n        var rows = _this.parent.activeViewOptions.headerRows;\n        _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows || _this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        _this.isStepDragging = !_this.isTimelineDayProcess && _this.actionObj.slotInterval !== _this.actionObj.interval;\n\n        if (_this.isTimelineDayProcess) {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n        } else {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n        }\n      }\n\n      if (_this.parent.currentView === 'TimelineYear') {\n        _this.yearEvent = new YearEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Month') {\n        _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n\n        _this.updateOriginalElement(_this.actionObj.clone);\n\n        _this.monthEvent = new MonthEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n        _this.verticalEvent = new VerticalEvent(_this.parent);\n\n        _this.verticalEvent.initializeValues();\n\n        var splitEvents = _this.splitEvent(_this.actionObj.event);\n\n        splitEvents.forEach(function (event) {\n          var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n\n          if (_this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n          }\n\n          var appWrap = _this.parent.element.querySelector(query);\n\n          if (appWrap) {\n            var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n\n            if (appEle) {\n              addClass([appEle], cls.EVENT_ACTION_CLASS);\n            }\n          }\n        });\n      }\n    });\n  };\n\n  DragAndDrop.prototype.getSelectedData = function () {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n        var element = _a[_i];\n        var eventGuid = element.getAttribute('data-guid');\n        var data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n\n    return this.multiData;\n  };\n\n  DragAndDrop.prototype.drag = function (e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(cls.DISABLE_DATES)) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventArgs = this.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      var date = this.parent.getDateFromElement(this.actionObj.target);\n\n      if (!isNullOrUndefined(date)) {\n        var currentDate = util.resetTime(date);\n        var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n\n    if (this.parent.eventDragArea) {\n      var targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      var currentTarget = closest(targetElement, '.' + cls.ROOT);\n\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    var dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n\n    this.parent.trigger(events.drag, dragArgs);\n  };\n\n  DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n\n    var startDate = eventObj[this.parent.eventFields.startTime];\n    var startTime = this.parent.activeView.renderDates[0];\n    var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE;\n    }\n  };\n\n  DragAndDrop.prototype.dragStop = function (e) {\n    var _this = this;\n\n    this.isCursorAhead = false;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    this.actionObj.action = null;\n\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n\n    var target = !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    var dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n\n      if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n        _this.parent.crudModule.crudObj.isCrudAction = true;\n        _this.parent.crudModule.crudObj.sourceEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n\n        var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n\n        _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n      }\n\n      _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  };\n\n  DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n    var _this = this;\n\n    if (this.actionObj.navigation.enable) {\n      var currentDate_1 = this.parent.getCurrentTime();\n\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(function () {\n          if (currentDate_1) {\n            var crtDate = _this.parent.getCurrentTime();\n\n            var end = crtDate.getSeconds();\n            var start = currentDate_1.getSeconds() + _this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n\n            if (start === end) {\n              currentDate_1 = _this.parent.getCurrentTime();\n\n              _this.viewNavigation(e);\n\n              _this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.navigationWrapper = function () {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n\n        if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          var elementHeight = this.getAllDayEventHeight();\n          var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n          if (event_2[0].offsetHeight < elementHeight) {\n            for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n              var e = event_1[_i];\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      var outWrapper = void 0;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n      }\n\n      var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!tarWrapper_1) {\n        tarWrapper_1 = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        outWrapper.appendChild(tarWrapper_1);\n      }\n\n      this.actionObj.cloneElement.forEach(function (ele) {\n        tarWrapper_1.appendChild(ele);\n      });\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.viewNavigation = function (e) {\n    var navigationType;\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'next' : 'previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'previous' : 'next';\n      }\n\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  };\n\n  DragAndDrop.prototype.morePopupEventDragging = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(e.target, 'td');\n\n    if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n      return;\n    }\n\n    var dragStart = this.parent.getDateFromElement(td);\n    var dragEnd = new Date(dragStart.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    this.actionObj.start = new Date(dragStart.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    var eventContainer = td;\n    var eventWrapper;\n\n    if (this.parent.activeView.isTimelineView()) {\n      var rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n\n    eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper);\n  };\n\n  DragAndDrop.prototype.calculateVerticalTime = function (e) {\n    var _this = this;\n\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventStart = eventObj[this.parent.eventFields.startTime];\n    var eventEnd = eventObj[this.parent.eventFields.endTime];\n    var eventDuration = eventEnd.getTime() - eventStart.getTime();\n    var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      this.actionObj.clone.style.top = formatUnit(offsetTop);\n    }\n\n    var rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    var tr;\n\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    } else {\n      var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[rowIndex];\n    }\n\n    var index;\n\n    if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n\n    var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n\n    var td = tr.children[colIndex];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    var dragStart;\n    var dragEnd;\n\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setMinutes(dragStart.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart.getTime());\n\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setDate(dragStart.getDate() - this.daysVariation);\n      dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n\n      if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n      }\n\n      this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n    }\n\n    this.actionObj.start = new Date(+dragStart);\n    this.actionObj.end = new Date(+dragEnd);\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n\n    for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n      var wrapper = dynamicWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        var targetCellTime_1 = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(function (data) {\n          _this.swagData.push(extend({}, data, null, true));\n\n          if (data[_this.parent.eventFields.isAllDay]) {\n            data[_this.parent.eventFields.startTime] = new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n            var startTime = new Date(data[_this.parent.eventFields.startTime]);\n            var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n            data[_this.parent.eventFields.endTime] = endTime;\n            data[_this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime_1;\n      }\n\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        var eventObj_1 = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n      }\n\n      var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n        this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n        var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n\n        if (dayIndex >= 0) {\n          var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n          this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n          this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n        } else {\n          if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n            remove(this.actionObj.cloneElement[index_1]);\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  };\n\n  DragAndDrop.prototype.splitEvent = function (event) {\n    var eventFields = this.parent.eventFields;\n    var eventData = [];\n    var startTime = event[eventFields.startTime];\n    var endTime = event[eventFields.endTime];\n\n    if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\n      var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\n      var endReferenceDate = new Date(startReferenceDate.getTime());\n\n      for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n        endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        var eventObj = extend({}, event, null, true);\n        eventObj[eventFields.startTime] = new Date(startReferenceDate);\n        eventObj[eventFields.endTime] = new Date(endReferenceDate);\n        startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        eventData.push(eventObj);\n      }\n\n      var index = eventData.length - 1;\n      eventData[0][eventFields.startTime] = startTime;\n      eventData[index][eventFields.endTime] = endTime;\n    } else {\n      eventData.push(event);\n    }\n\n    return eventData;\n  };\n\n  DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n\n    var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.getDayIndex = function (event) {\n    var eventObj = extend({}, event, null, true);\n    var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n    var query = '';\n    var wrapper = cls.DAY_WRAPPER_CLASS;\n\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = cls.WORK_CELLS_CLASS;\n    }\n\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n\n    this.targetTd = this.parent.element.querySelector(query);\n\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n\n    return this.targetTd.cellIndex;\n  };\n\n  DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    var datesCount = 0;\n\n    if (!this.parent.uiStateValues.isGroupAdaptive) {\n      for (var i = 0; i < this.actionObj.groupIndex; i++) {\n        datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n      }\n    }\n\n    var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n    var target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      var dynamicIndex = -1;\n      var dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime( // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      var splitEvents = this.splitEvent(event);\n      var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 || this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n\n      for (var i = 0; i < events_1.length; i++) {\n        if (i > 0) {\n          var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n          }\n\n          var appWrap = this.parent.element.querySelector(filterQuery);\n\n          if (appWrap) {\n            dayIndex = dayIndex + 1;\n            dynamicIndex = appWrap.cellIndex;\n          } else {\n            dayIndex = -1;\n          }\n        }\n\n        if (dayIndex >= 0) {\n          var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\n          var eStart = record[this.verticalEvent.fields.startTime];\n          var eEnd = record[this.verticalEvent.fields.endTime];\n          var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n          var topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n\n          if (isNullOrUndefined(index)) {\n            if (i === 0) {\n              this.actionObj.clone.style.top = formatUnit(topValue);\n              this.actionObj.clone.style.height = formatUnit(appHeight);\n            } else {\n              this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n            }\n          } else {\n            var appWidth = this.actionObj.cellWidth;\n\n            if (event[this.parent.eventFields.isAllDay]) {\n              topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n              appHeight = this.getAllDayEventHeight();\n              var timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n              var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n\n              if (allDayDifference >= 0) {\n                appWidth = allDayDifference * this.actionObj.cellWidth;\n              }\n            }\n\n            if (this.actionObj.cloneElement[index]) {\n              if (i === 0) {\n                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n              } else {\n                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n\n  DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n    var startTime = record[this.parent.eventFields.startTime].getTime();\n    var endTime = record[this.parent.eventFields.endTime].getTime();\n\n    if (startTime !== endTime) {\n      var appointmentElement = this.verticalEvent.createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n      addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': height + 'px',\n        'top': top + 'px',\n        'border': '0px'\n      });\n      var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n      appointmentWrap[index].appendChild(appointmentElement);\n    }\n  };\n\n  DragAndDrop.prototype.getRenderedDates = function () {\n    var _this = this;\n\n    var _a, _b;\n\n    var renderDates = this.parent.activeView.renderDates;\n\n    (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      var resources = this.parent.resourceBase.lastResourceLevel.filter(function (res) {\n        return res.groupIndex === _this.actionObj.groupIndex;\n      });\n      renderDates = resources[0].renderDates;\n\n      (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) {\n        return +date;\n      }));\n    }\n\n    return renderDates;\n  };\n\n  DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n    this.parent.eventBase.slots = [];\n    var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    var renderDates = this.getRenderedDates();\n    var events = this.parent.eventBase.splitEvent(event, renderDates);\n    var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n\n    var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex)); // eslint-disable-next-line max-len\n\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.swapDragging = function (e) {\n    var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n\n    if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      var eventHeight = this.getAllDayEventHeight();\n      var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n          var element = allDayElement_1[_i];\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n\n    if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false; // eslint-disable-next-line max-len\n\n      var height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  };\n\n  DragAndDrop.prototype.calculateVerticalDate = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      this.removeCloneElement();\n    }\n\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(this.actionObj.target, 'td');\n\n    if (!isNullOrUndefined(td)) {\n      var tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      var currentDate = this.parent.getDateFromElement(td);\n\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n\n        var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        var dragStart = new Date(timeString.getTime());\n        var dragEnd = new Date(dragStart.getTime());\n        var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() - util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])).getTime();\n        dragStart = new Date(dragStart.getTime() + startTimeDiff);\n        dragEnd = new Date(dragStart.getTime() + eventDuration);\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n\n    for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n      var wrapper = eventWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData && this.multiData.length > 0) {\n      var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n      var startTimeDiff = startTime.getTime() - this.startTime;\n\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n\n      for (var index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[index]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[index]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.calculateTimelineTime = function (e) {\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    var rightOffset;\n\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    var colIndex = this.getColumnIndex(offsetLeft);\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl && this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n    var leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n\n    if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n      this.isCursorAhead = true;\n    }\n\n    var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n\n    var tr = this.parent.getContentTable().querySelector('tr');\n    var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) : this.parent.getDateFromElement(tr.children[index]);\n\n    if (this.isStepDragging) {\n      var widthDiff = this.getWidthDiff(tr, index);\n\n      if (widthDiff !== 0) {\n        var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n\n        if (this.isCursorAhead || cursorDrag) {\n          eventStart.setMilliseconds(-eventDuration);\n        } else {\n          eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n        }\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      if (this.isCursorAhead || cursorDrag) {\n        eventStart.setMinutes(eventStart.getMinutes() + (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n        eventStart.setMilliseconds(-eventDuration);\n      } else {\n        eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n      }\n    }\n\n    eventStart = this.calculateIntervalTime(eventStart);\n\n    if (this.isTimelineDayProcess) {\n      var eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n\n    if (this.parent.eventDragArea) {\n      var targetDate = this.parent.getDateFromElement(e.target);\n\n      if (!isNullOrUndefined(targetDate)) {\n        if (!this.parent.activeViewOptions.timeScale.enable || this.parent.currentView === 'TimelineMonth') {\n          var eventSrt = eventObj[this.parent.eventFields.startTime];\n          eventStart = new Date(eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n        } else {\n          eventStart = targetDate;\n        }\n      }\n    }\n\n    var eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n\n    if (this.multiData.length > 0) {\n      var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var i = 0; i < this.multiData.length; i++) {\n        this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n      }\n\n      eventsData = this.updatedData;\n    }\n\n    for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n      var eventData = events_2[0].data;\n      var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n      var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData); // eslint-disable-next-line max-len\n\n      var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count); // eslint-disable-next-line max-len\n\n      var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n      day = day < 0 ? 0 : day;\n      var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n      var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n\n      if (this.parent.enableRtl) {\n        cloneElement.style.right = formatUnit(left);\n      } else {\n        cloneElement.style.left = formatUnit(left);\n      }\n\n      if (!this.isMorePopupOpened) {\n        cloneElement.style.width = formatUnit(width);\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  };\n\n  DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n\n        this.actionObj.clone.style.left = formatUnit(rightOffset);\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        this.actionObj.clone.style.left = formatUnit(offsetLeft);\n      }\n    }\n\n    return offsetLeft;\n  };\n\n  DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n    var pages = this.scrollArgs.element.getBoundingClientRect();\n\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      var targetLeft = tr.children[index].offsetLeft;\n      var pageX = this.actionObj.pageX - pages.left;\n\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n\n    return 0;\n  };\n\n  DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n    var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n\n    if (this.isHeaderRows) {\n      return index;\n    }\n\n    return this.getIndex(index);\n  };\n\n  DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n    var index = colIndex + cloneIndex;\n\n    if (this.isHeaderRows) {\n      var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  };\n\n  DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n    var td = closest(e.target, '.e-work-cells');\n\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      var targetDate = this.parent.getDateFromElement(td);\n\n      if (this.isHeaderRows) {\n        var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n\n      var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n\n      if (this.isTimelineDayProcess) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / util.MS_PER_DAY));\n      } else {\n        var widthDiff = Math.floor(timeDiff / util.MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  };\n\n  DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    var translateY = util.getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    var rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    var rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset)) - dragArea.getBoundingClientRect().top) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper, cloneElement);\n    var td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n\n    if (this.parent.rowAutoHeight) {\n      var cursorElement = this.getCursorElement(e);\n\n      if (cursorElement) {\n        top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n\n    cloneElement.style.top = formatUnit(top);\n  };\n\n  DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n    if (cloneElement === void 0) {\n      cloneElement = null;\n    }\n\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n\n    if (this.parent.eventDragArea && dragElement) {\n      dragElement.appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  };\n\n  DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n    var eventWrapper;\n\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n\n    return eventWrapper;\n  };\n\n  DragAndDrop.prototype.getAllDayEventHeight = function () {\n    var eventWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    var eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  };\n\n  DragAndDrop.prototype.isAllowDrop = function (e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n\n    var dropSelectors = this.actionObj.excludeSelectors.split(',');\n    var isAllowDrop = false;\n\n    for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n      var selector = dropSelectors_1[_i];\n\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n\n    return isAllowDrop;\n  };\n  /**\r\n   * Get module name.\r\n   *\r\n   * @returns {string} Returns the module name\r\n   */\n\n\n  DragAndDrop.prototype.getModuleName = function () {\n    return 'dragAndDrop';\n  };\n\n  return DragAndDrop;\n}(ActionBase);\n\nexport { DragAndDrop };","map":{"version":3,"sources":["D:/HUST/20211/Introduction to Software Engineering/Project/Sprint 2/RubyGYM/client/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/drag.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createElement","closest","Draggable","extend","formatUnit","isNullOrUndefined","addClass","remove","removeClass","setStyleAttribute","ActionBase","MonthEvent","TimelineEvent","YearEvent","VerticalEvent","cls","events","util","MINUTES_PER_DAY","DragAndDrop","_super","_this","apply","arguments","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","isMultiSelect","multiData","updatedData","swagData","startTime","isAllDayTarget","targetTd","isCursorAhead","wireDragEvent","element","abort","EVENT_RESIZE_CLASS","clone","isDragScroll","enableTapHold","parent","isAdaptive","enableTailMode","eventDragArea","cursorAt","left","top","dragArea","dragStart","bind","drag","dragStop","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","setDragArea","dragElement","document","querySelector","CONTENT_TABLE_CLASS","e","setDragActionDefaultValues","actionObj","action","elements","allowMultiDrag","selectedElements","length","indexOf","forEach","ele","cloneElement","createCloneElement","getAttribute","currentView","activeViewOptions","timeScale","enable","activeView","isTimelineView","classList","contains","ALLDAY_APPOINTMENT_CLASS","cursor","right","width","style","offsetTop","push","originalElement","cellHeight","slotInterval","interval","leftValue","cloneRight","Math","ceil","getBoundingClientRect","CONTENT_WRAP_CLASS","contentWrapRight","enableRtl","pageX","offsetLeft","topValue","offsetParent","MORE_EVENT_POPUP_CLASS","ALLDAY_ROW_CLASS","offsetWidth","cellWidth","height","pointerEvents","top_1","parseInt","scrollHeight","cloneBottom","offsetHeight","isAllDay","slotCount","workCell","WORK_CELLS_CLASS","eventGuid","event","eventBase","getEventByGuid","eventObj","eventFields","getTime","dragArgs","cancel","data","selectedData","getSelectedData","excludeSelectors","navigation","timeDelay","scroll","scrollBy","trigger","dragEventArgs","parentElement","dragObj","ej2_instances","intDestroy","removeCloneElementClasses","removeCloneElement","actionClass","uiStateValues","start","end","endTime","groupIndex","viewElement","scrollArgs","scrollWidth","daysVariation","rows","headerRows","option","timelineEventModule","yearEvent","resetTime","Date","updateOriginalElement","monthEvent","verticalEvent","initializeValues","splitEvents","splitEvent","query","group","resources","concat","appWrap","appEle","EVENT_ACTION_CLASS","_i","_a","quickPopup","quickPopupHide","target","DISABLE_DATES","eventArgs","getPageCoordinates","Y","pageY","X","abs","calculateMinutesDiff","date","getDateFromElement","currentDate","startDate","MS_PER_DAY","targetElement","currentTarget","ROOT","updateScrollPosition","updateNavigatingPosition","updateDraggingDateTime","renderDates","startEndHours","getStartEndHours","getStartHour","getEndHour","startHour","MS_PER_MINUTE","clearInterval","navigationInterval","scrollInterval","isAllowDrop","cellTemplate","getChangedData","allowGroupEdit","rowAutoHeight","virtualScrollModule","byGroupID","crudModule","crudObj","isCrudAction","sourceEvent","resourceBase","lastResourceLevel","currentGroupIndex","targetEvent","saveChangedData","currentDate_1","getCurrentTime","window","setInterval","crtDate","getSeconds","viewNavigation","morePopupEventDragging","dateRender","getSlotDates","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","navigationWrapper","outerWrapperCls","slice","call","querySelectorAll","index","targetWrapper","APPOINTMENT_WRAPPER_CLASS","className","appendChild","wrapperClass","ALLDAY_APPOINTMENT_WRAPPER_CLASS","item","elementHeight","getAllDayEventHeight","event_2","ALLDAY_CELLS_CLASS","event_1","outWrapper","APPOINTMENT_CONTAINER_CLASS","tarWrapper_1","navigationType","scrollEdges","bottom","scrollLeft","round","pageXOffset","clientWidth","changeDate","getNextPreviousDate","eventDuration","td","dragEnd","setMilliseconds","eventContainer","eventWrapper","rowIndex","appendCloneElement","swapDragging","eventStart","eventEnd","floor","scrollTop","pageYOffset","diffInMinutes","tr","trCollections","getContentTable","cellIndex","colIndex","children","isGroupAdaptive","getEventWrapper","setMinutes","getMinutes","setDate","getDate","setHours","getHours","addDays","updateAllDayEvents","byDate","undefined","getUpdatedEvent","dynamicWrappers","dynamicWrappers_1","wrapper","targetCellTime_1","eventObj_1","startTimeDiff","index_1","updateMultipleData","dayIndex","getDayIndex","updateEventHeight","parentNode","updateTimePosition","eventData","startReferenceDate","endReferenceDate","i","timeDifference","endTimeDiff","differInDays","day","DAY_WRAPPER_CLASS","datesCount","indexGroup","dynamicIndex","getIndexOfDate","events_1","isAllDayAppointment","eventSettings","spannedEventPlacement","filterQuery","record","isSpannedEvent","eStart","fields","eEnd","appHeight","getHeight","getTopValue","renderSpannedEvents","appWidth","timeDiff","allDayDifference","appointmentElement","createAppointmentElement","isSpanned","CLONE_ELEMENT_CLASS","appointmentWrap","getRenderedDates","_b","slots","map","filter","res","endDate","cell","count","DATE_HEADER_WRAP_CLASS","eventHeight","allDayElement","allDayElement_1","tagName","workCells","timeString","eventWrappers","eventWrappers_1","getFullYear","getMonth","updateMultipleVerticalDate","dynamicYearlyEventsRendering","dynamicEventsRendering","setMonth","rightOffset","getOffsetValue","getColumnIndex","cursorDrag","leftVal","cloneIndex","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","calculateIntervalTime","eventSrt","targetDate","eventsData","dataIndex","events_2","getStartTime","getEndTime","getEventWidth","getPosition","calculateResourceGroupingPosition","viewEle","pages","targetLeft","getIndex","dateLength","currentIndex","trCollection","translateY","getTranslateY","rowHeight","scrollY","isNaN","cursorElement","getCursorElement","APPOINTMENT_CLASS","dropSelectors","split","dropSelectors_1","selector","getModuleName"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\r\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\r\nimport { ActionBase } from '../actions/action-base';\r\nimport { MonthEvent } from '../event-renderer/month';\r\nimport { TimelineEvent } from '../event-renderer/timeline-view';\r\nimport { YearEvent } from '../event-renderer/year';\r\nimport { VerticalEvent } from '../event-renderer/vertical-view';\r\nimport * as cls from '../base/css-constant';\r\nimport * as events from '../base/constant';\r\nimport * as util from '../base/util';\r\nvar MINUTES_PER_DAY = 1440;\r\n/**\r\n * Schedule events drag actions\r\n */\r\nvar DragAndDrop = /** @class */ (function (_super) {\r\n    __extends(DragAndDrop, _super);\r\n    function DragAndDrop() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.widthUptoCursorPoint = 0;\r\n        _this.heightUptoCursorPoint = 0;\r\n        _this.cursorPointIndex = 0;\r\n        _this.isHeaderRows = false;\r\n        _this.isTimelineDayProcess = false;\r\n        _this.widthPerMinute = 0;\r\n        _this.heightPerMinute = 0;\r\n        _this.minDiff = 0;\r\n        _this.isStepDragging = false;\r\n        _this.isMorePopupOpened = false;\r\n        _this.isAllDayDrag = false;\r\n        _this.isMultiSelect = false;\r\n        _this.multiData = [];\r\n        _this.updatedData = [];\r\n        _this.swagData = [];\r\n        _this.startTime = 0;\r\n        _this.isAllDayTarget = false;\r\n        _this.targetTd = null;\r\n        _this.isCursorAhead = false;\r\n        return _this;\r\n    }\r\n    DragAndDrop.prototype.wireDragEvent = function (element) {\r\n        new Draggable(element, {\r\n            abort: '.' + cls.EVENT_RESIZE_CLASS,\r\n            clone: true,\r\n            isDragScroll: true,\r\n            enableTapHold: this.parent.isAdaptive,\r\n            enableTailMode: (this.parent.eventDragArea) ? true : false,\r\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\r\n            dragArea: this.dragArea,\r\n            dragStart: this.dragStart.bind(this),\r\n            drag: this.drag.bind(this),\r\n            dragStop: this.dragStop.bind(this),\r\n            enableAutoScroll: false,\r\n            helper: this.dragHelper.bind(this),\r\n            queryPositionInfo: this.dragPosition.bind(this)\r\n        });\r\n    };\r\n    DragAndDrop.prototype.setDragArea = function () {\r\n        var dragElement = document.querySelector(this.parent.eventDragArea);\r\n        this.dragArea = this.parent.eventDragArea && dragElement ? dragElement :\r\n            this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\r\n    };\r\n    DragAndDrop.prototype.dragHelper = function (e) {\r\n        var _this = this;\r\n        this.setDragActionDefaultValues();\r\n        this.actionObj.element = e.element;\r\n        this.actionObj.action = 'drag';\r\n        var elements = [];\r\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\r\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\r\n            elements = [e.element];\r\n        }\r\n        else {\r\n            elements = this.parent.selectedElements;\r\n            this.isMultiSelect = true;\r\n        }\r\n        elements.forEach(function (ele) {\r\n            var cloneElement = _this.createCloneElement(ele);\r\n            if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\r\n                _this.actionObj.clone = cloneElement;\r\n                if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' &&\r\n                    _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() &&\r\n                    !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\r\n                    setStyleAttribute(_this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\r\n                }\r\n                _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\r\n            }\r\n            _this.actionObj.cloneElement.push(cloneElement);\r\n            _this.actionObj.originalElement.push(ele);\r\n        });\r\n        return this.actionObj.clone;\r\n    };\r\n    DragAndDrop.prototype.dragPosition = function (e) {\r\n        if (this.parent.eventDragArea) {\r\n            return { left: e.left, top: e.top };\r\n        }\r\n        var cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\r\n        var leftValue = formatUnit(0);\r\n        if (this.parent.currentView === 'Month') {\r\n            leftValue = e.left;\r\n        }\r\n        var cloneRight;\r\n        if (this.isStepDragging) {\r\n            cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\r\n        }\r\n        else {\r\n            cloneRight = this.actionObj.clone.getBoundingClientRect().right;\r\n        }\r\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\r\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl &&\r\n            this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\r\n            this.isCursorAhead = true;\r\n        }\r\n        if (this.parent.activeView.isTimelineView()) {\r\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\r\n        }\r\n        var topValue;\r\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\r\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\r\n                this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)))) {\r\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\r\n        }\r\n        else if (this.parent.currentView === 'Month') {\r\n            topValue = formatUnit(0);\r\n        }\r\n        else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\r\n            topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\r\n            setStyleAttribute(this.actionObj.clone, {\r\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\r\n                right: this.parent.enableRtl && formatUnit(0)\r\n            });\r\n        }\r\n        else {\r\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\r\n                !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\r\n                setStyleAttribute(this.actionObj.clone, {\r\n                    height: formatUnit(this.actionObj.cellHeight),\r\n                    width: formatUnit(this.actionObj.cellWidth - 1),\r\n                    pointerEvents: 'none'\r\n                });\r\n            }\r\n            var top_1 = parseInt(e.top, 10);\r\n            top_1 = top_1 < 0 ? 0 : top_1;\r\n            topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\r\n            var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\r\n            var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\r\n            if (cloneBottom > scrollHeight) {\r\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\r\n            }\r\n        }\r\n        return { left: leftValue, top: topValue };\r\n    };\r\n    DragAndDrop.prototype.setDragActionDefaultValues = function () {\r\n        this.actionObj.action = 'drag';\r\n        this.actionObj.isAllDay = null;\r\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\r\n        this.actionObj.interval = this.actionObj.slotInterval;\r\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\r\n        this.actionObj.cellWidth = workCell.offsetWidth;\r\n        this.actionObj.cellHeight = workCell.offsetHeight;\r\n    };\r\n    DragAndDrop.prototype.dragStart = function (e) {\r\n        var _this = this;\r\n        var eventGuid = this.actionObj.element.getAttribute('data-guid');\r\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\r\n        var eventObj = extend({}, this.actionObj.event, null, true);\r\n        if (!isNullOrUndefined(eventObj)) {\r\n            this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\r\n        }\r\n        var dragArgs = {\r\n            cancel: false,\r\n            data: eventObj,\r\n            selectedData: this.getSelectedData(),\r\n            event: e,\r\n            excludeSelectors: null,\r\n            element: this.actionObj.element,\r\n            interval: this.actionObj.interval,\r\n            navigation: { enable: false, timeDelay: 2000 },\r\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\r\n        };\r\n        this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\r\n            if (dragEventArgs.cancel || (!isNullOrUndefined(_this.actionObj.element) &&\r\n                isNullOrUndefined(_this.actionObj.element.parentElement))) {\r\n                var dragObj = _this.actionObj.element.ej2_instances[0];\r\n                if (!isNullOrUndefined(dragObj)) {\r\n                    dragObj.intDestroy(e.event);\r\n                }\r\n                _this.actionObj.action = '';\r\n                _this.removeCloneElementClasses();\r\n                _this.removeCloneElement();\r\n                return;\r\n            }\r\n            _this.actionClass('addClass');\r\n            _this.parent.uiStateValues.action = true;\r\n            _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\r\n            _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\r\n            _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\r\n            _this.actionObj.interval = dragEventArgs.interval;\r\n            _this.actionObj.navigation = dragEventArgs.navigation;\r\n            _this.actionObj.scroll = dragEventArgs.scroll;\r\n            _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\r\n            var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n            _this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\r\n            _this.widthPerMinute = (_this.actionObj.cellWidth / _this.actionObj.slotInterval) * _this.actionObj.interval;\r\n            _this.heightPerMinute = (_this.actionObj.cellHeight / _this.actionObj.slotInterval) * _this.actionObj.interval;\r\n            _this.widthUptoCursorPoint = 0;\r\n            _this.heightUptoCursorPoint = 0;\r\n            _this.cursorPointIndex = -1;\r\n            _this.isHeaderRows = false;\r\n            _this.isTimelineDayProcess = false;\r\n            _this.minDiff = 0;\r\n            _this.isMorePopupOpened = false;\r\n            _this.daysVariation = -1;\r\n            _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\r\n            if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\r\n                if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) &&\r\n                    _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\r\n                    _this.isMorePopupOpened = true;\r\n                }\r\n                _this.actionObj.pageX = e.event.pageX;\r\n                var rows = _this.parent.activeViewOptions.headerRows;\r\n                _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\r\n                    rows[rows.length - 1].option !== 'Date';\r\n                _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows ||\r\n                    _this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\r\n                _this.isStepDragging = !_this.isTimelineDayProcess && (_this.actionObj.slotInterval !== _this.actionObj.interval);\r\n                if (_this.isTimelineDayProcess) {\r\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\r\n                }\r\n                else {\r\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\r\n                }\r\n            }\r\n            if (_this.parent.currentView === 'TimelineYear') {\r\n                _this.yearEvent = new YearEvent(_this.parent);\r\n            }\r\n            if (_this.parent.currentView === 'Month') {\r\n                _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\r\n                _this.updateOriginalElement(_this.actionObj.clone);\r\n                _this.monthEvent = new MonthEvent(_this.parent);\r\n            }\r\n            if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\r\n                _this.verticalEvent = new VerticalEvent(_this.parent);\r\n                _this.verticalEvent.initializeValues();\r\n                var splitEvents = _this.splitEvent(_this.actionObj.event);\r\n                splitEvents.forEach(function (event) {\r\n                    var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\r\n                    if (_this.parent.activeViewOptions.group.resources.length > 0) {\r\n                        query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\r\n                    }\r\n                    var appWrap = _this.parent.element.querySelector(query);\r\n                    if (appWrap) {\r\n                        var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\r\n                        if (appEle) {\r\n                            addClass([appEle], cls.EVENT_ACTION_CLASS);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    };\r\n    DragAndDrop.prototype.getSelectedData = function () {\r\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\r\n            for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\r\n                var element = _a[_i];\r\n                var eventGuid = element.getAttribute('data-guid');\r\n                var data = this.parent.eventBase.getEventByGuid(eventGuid);\r\n                this.multiData.push(extend({}, data, null, true));\r\n            }\r\n        }\r\n        return this.multiData;\r\n    };\r\n    DragAndDrop.prototype.drag = function (e) {\r\n        if (this.parent.quickPopup) {\r\n            this.parent.quickPopup.quickPopupHide(true);\r\n        }\r\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(cls.DISABLE_DATES)) {\r\n            return;\r\n        }\r\n        var eventObj = extend({}, this.actionObj.event, null, true);\r\n        var eventArgs = this.getPageCoordinates(e);\r\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\r\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\r\n        this.actionObj.target = e.target;\r\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\r\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\r\n                this.widthPerMinute : this.widthUptoCursorPoint;\r\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\r\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\r\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\r\n                this.heightPerMinute : this.heightUptoCursorPoint;\r\n        this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\r\n            this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) :\r\n            this.actionObj.event[this.parent.eventFields.isAllDay];\r\n        if (this.isStepDragging && this.minDiff === 0) {\r\n            this.calculateMinutesDiff(eventObj);\r\n        }\r\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\r\n            var date = this.parent.getDateFromElement(this.actionObj.target);\r\n            if (!isNullOrUndefined(date)) {\r\n                var currentDate = util.resetTime(date);\r\n                var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\r\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\r\n            }\r\n            else {\r\n                this.daysVariation = 0;\r\n            }\r\n        }\r\n        else {\r\n            this.daysVariation = 0;\r\n        }\r\n        if (this.parent.eventDragArea) {\r\n            var targetElement = eventArgs.target;\r\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\r\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\r\n            var currentTarget = closest(targetElement, '.' + cls.ROOT);\r\n            if (!currentTarget) {\r\n                this.actionObj.clone.style.height = '';\r\n                this.actionObj.clone.style.width = '';\r\n            }\r\n            else {\r\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\r\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\r\n                }\r\n            }\r\n        }\r\n        this.updateScrollPosition(e);\r\n        this.updateNavigatingPosition(e);\r\n        this.updateDraggingDateTime(e);\r\n        var dragArgs = {\r\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\r\n            endTime: this.actionObj.end, selectedData: this.updatedData\r\n        };\r\n        if (this.parent.group.resources.length > 0) {\r\n            dragArgs.groupIndex = this.actionObj.groupIndex;\r\n        }\r\n        this.parent.trigger(events.drag, dragArgs);\r\n    };\r\n    DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\r\n        if (this.parent.enableRtl) {\r\n            this.minDiff =\r\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\r\n        }\r\n        else {\r\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\r\n        }\r\n        var startDate = eventObj[this.parent.eventFields.startTime];\r\n        var startTime = this.parent.activeView.renderDates[0];\r\n        var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\r\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\r\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE);\r\n        }\r\n    };\r\n    DragAndDrop.prototype.dragStop = function (e) {\r\n        var _this = this;\r\n        this.isCursorAhead = false;\r\n        this.removeCloneElementClasses();\r\n        this.removeCloneElement();\r\n        clearInterval(this.actionObj.navigationInterval);\r\n        this.actionObj.navigationInterval = null;\r\n        clearInterval(this.actionObj.scrollInterval);\r\n        this.actionObj.scrollInterval = null;\r\n        this.actionClass('removeClass');\r\n        this.parent.uiStateValues.action = false;\r\n        this.actionObj.action = null;\r\n        if (this.isAllowDrop(e)) {\r\n            return;\r\n        }\r\n        var target = ((!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\r\n            closest(e.target, '.e-work-cells') : e.target);\r\n        var dragArgs = {\r\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\r\n            event: e, element: this.actionObj.element, target: target\r\n        };\r\n        this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\r\n            if (dragEventArgs.cancel) {\r\n                return;\r\n            }\r\n            if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit\r\n                && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\r\n                _this.parent.crudModule.crudObj.isCrudAction = true;\r\n                _this.parent.crudModule.crudObj.sourceEvent =\r\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\r\n                var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\r\n                _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\r\n            }\r\n            _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\r\n        });\r\n        this.updatedData = [];\r\n        this.multiData = [];\r\n        this.isMultiSelect = false;\r\n        this.parent.selectedElements = [];\r\n    };\r\n    DragAndDrop.prototype.updateNavigatingPosition = function (e) {\r\n        var _this = this;\r\n        if (this.actionObj.navigation.enable) {\r\n            var currentDate_1 = this.parent.getCurrentTime();\r\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\r\n                this.actionObj.navigationInterval = window.setInterval(function () {\r\n                    if (currentDate_1) {\r\n                        var crtDate = _this.parent.getCurrentTime();\r\n                        var end = crtDate.getSeconds();\r\n                        var start = currentDate_1.getSeconds() + (_this.actionObj.navigation.timeDelay / 1000);\r\n                        start = (start >= 60) ? start - 60 : start;\r\n                        if (start === end) {\r\n                            currentDate_1 = _this.parent.getCurrentTime();\r\n                            _this.viewNavigation(e);\r\n                            _this.updateDraggingDateTime(e);\r\n                        }\r\n                    }\r\n                }, this.actionObj.navigation.timeDelay);\r\n            }\r\n        }\r\n    };\r\n    DragAndDrop.prototype.updateDraggingDateTime = function (e) {\r\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\r\n            this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\r\n            this.morePopupEventDragging(e);\r\n        }\r\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\r\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\r\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\r\n            this.timelineEventModule.getSlotDates();\r\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\r\n            this.calculateTimelineTime(e);\r\n        }\r\n        else {\r\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\r\n                this.calculateVerticalDate(e);\r\n            }\r\n            else {\r\n                this.calculateVerticalTime(e);\r\n            }\r\n        }\r\n    };\r\n    DragAndDrop.prototype.navigationWrapper = function () {\r\n        if (!this.parent.activeView.isTimelineView()) {\r\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\r\n                var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\r\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\r\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\r\n                var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\r\n                if (!targetWrapper) {\r\n                    targetWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\r\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\r\n                }\r\n                targetWrapper.appendChild(this.actionObj.clone);\r\n            }\r\n            else {\r\n                var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ?\r\n                    '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\r\n                this.parent.element.querySelectorAll(wrapperClass)\r\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\r\n                if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\r\n                    var elementHeight = this.getAllDayEventHeight();\r\n                    var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\r\n                    if (event_2[0].offsetHeight < elementHeight) {\r\n                        for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\r\n                            var e = event_1[_i];\r\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\r\n                        }\r\n                    }\r\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\r\n                }\r\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\r\n            }\r\n        }\r\n        else {\r\n            var outWrapper = void 0;\r\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\r\n            }\r\n            else {\r\n                outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\r\n            }\r\n            var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\r\n            if (!tarWrapper_1) {\r\n                tarWrapper_1 = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\r\n                outWrapper.appendChild(tarWrapper_1);\r\n            }\r\n            this.actionObj.cloneElement.forEach(function (ele) {\r\n                tarWrapper_1.appendChild(ele);\r\n            });\r\n        }\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    DragAndDrop.prototype.viewNavigation = function (e) {\r\n        var navigationType;\r\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\r\n            closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\r\n            if ((dragArea.scrollLeft === 0) &&\r\n                (Math.round(this.actionObj.X) <=\r\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\r\n                navigationType = this.parent.enableRtl ? 'next' : 'previous';\r\n            }\r\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\r\n                (Math.round(this.actionObj.X) >=\r\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\r\n                navigationType = this.parent.enableRtl ? 'previous' : 'next';\r\n            }\r\n            if (navigationType) {\r\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\r\n            }\r\n        }\r\n    };\r\n    DragAndDrop.prototype.morePopupEventDragging = function (e) {\r\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\r\n            return;\r\n        }\r\n        var eventObj = extend({}, this.actionObj.event, null, true);\r\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\r\n            eventObj[this.parent.eventFields.startTime].getTime();\r\n        var td = closest(e.target, 'td');\r\n        if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\r\n            return;\r\n        }\r\n        var dragStart = this.parent.getDateFromElement(td);\r\n        var dragEnd = new Date(dragStart.getTime());\r\n        dragEnd.setMilliseconds(eventDuration);\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\r\n        }\r\n        this.actionObj.start = new Date(dragStart.getTime());\r\n        this.actionObj.end = new Date(dragEnd.getTime());\r\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\r\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\r\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\r\n        var eventContainer = td;\r\n        var eventWrapper;\r\n        if (this.parent.activeView.isTimelineView()) {\r\n            var rowIndex = closest(td, 'tr').rowIndex;\r\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\r\n        }\r\n        eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\r\n        if (!eventWrapper) {\r\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\r\n            eventContainer.appendChild(eventWrapper);\r\n        }\r\n        this.appendCloneElement(eventWrapper);\r\n    };\r\n    DragAndDrop.prototype.calculateVerticalTime = function (e) {\r\n        var _this = this;\r\n        if (isNullOrUndefined(this.actionObj.target) ||\r\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\r\n            (!(closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS)) &&\r\n                !(closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)))) {\r\n            return;\r\n        }\r\n        if (this.parent.activeViewOptions.timeScale.enable) {\r\n            this.swapDragging(e);\r\n        }\r\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n        var eventObj = extend({}, this.actionObj.event, null, true);\r\n        var eventStart = eventObj[this.parent.eventFields.startTime];\r\n        var eventEnd = eventObj[this.parent.eventFields.endTime];\r\n        var eventDuration = eventEnd.getTime() - eventStart.getTime();\r\n        var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\r\n            * this.actionObj.cellHeight;\r\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\r\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\r\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\r\n                this.actionObj.cellHeight + window.pageYOffset :\r\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\r\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\r\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\r\n            this.actionObj.clone.style.top = formatUnit(offsetTop);\r\n        }\r\n        var rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\r\n        var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\r\n        var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\r\n        var tr;\r\n        if (this.isAllDayDrag) {\r\n            tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\r\n        }\r\n        else {\r\n            var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\r\n            tr = trCollections[rowIndex];\r\n        }\r\n        var index;\r\n        if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) ||\r\n            closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\r\n            index = closest(this.actionObj.target, 'td').cellIndex;\r\n        }\r\n        var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\r\n        this.actionObj.index = colIndex;\r\n        if (isNullOrUndefined(tr)) {\r\n            return;\r\n        }\r\n        var td = tr.children[colIndex];\r\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\r\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\r\n        }\r\n        var dragStart;\r\n        var dragEnd;\r\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\r\n            this.appendCloneElement(this.getEventWrapper(colIndex));\r\n            dragStart = this.parent.getDateFromElement(td);\r\n            dragStart.setMinutes(dragStart.getMinutes() + (diffInMinutes / heightPerMinute));\r\n            dragEnd = new Date(dragStart.getTime());\r\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\r\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\r\n            }\r\n            else {\r\n                dragEnd.setMilliseconds(eventDuration);\r\n            }\r\n        }\r\n        else {\r\n            dragStart = this.parent.getDateFromElement(td);\r\n            dragStart.setDate(dragStart.getDate() - this.daysVariation);\r\n            dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\r\n            dragEnd = new Date(dragStart.getTime());\r\n            dragEnd.setMilliseconds(eventDuration);\r\n            if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\r\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\r\n                dragEnd = util.addDays(util.resetTime(dragEnd), 1);\r\n            }\r\n            this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\r\n        }\r\n        this.actionObj.start = new Date(+dragStart);\r\n        this.actionObj.end = new Date(+dragEnd);\r\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\r\n        var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\r\n        for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\r\n            var wrapper = dynamicWrappers_1[_i];\r\n            remove(wrapper);\r\n        }\r\n        if (this.multiData.length > 0) {\r\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\r\n                var targetCellTime_1 = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\r\n                this.multiData.forEach(function (data) {\r\n                    _this.swagData.push(extend({}, data, null, true));\r\n                    if (data[_this.parent.eventFields.isAllDay]) {\r\n                        data[_this.parent.eventFields.startTime] =\r\n                            new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\r\n                        var startTime = new Date(data[_this.parent.eventFields.startTime]);\r\n                        var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\r\n                        data[_this.parent.eventFields.endTime] = endTime;\r\n                        data[_this.parent.eventFields.isAllDay] = false;\r\n                    }\r\n                });\r\n                this.startTime = targetCellTime_1;\r\n            }\r\n            if (this.isAllDayTarget && this.isAllDayDrag &&\r\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\r\n                this.multiData = this.swagData;\r\n                this.swagData = [];\r\n                var eventObj_1 = extend({}, this.actionObj.event, null, true);\r\n                this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\r\n            }\r\n            var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\r\n            for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\r\n                this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\r\n                var dayIndex = this.getDayIndex(this.updatedData[index_1]);\r\n                if (dayIndex >= 0) {\r\n                    var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\r\n                    this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\r\n                    this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\r\n                }\r\n                else {\r\n                    if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\r\n                        remove(this.actionObj.cloneElement[index_1]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.updateEventHeight(event);\r\n        }\r\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\r\n    };\r\n    DragAndDrop.prototype.splitEvent = function (event) {\r\n        var eventFields = this.parent.eventFields;\r\n        var eventData = [];\r\n        var startTime = event[eventFields.startTime];\r\n        var endTime = event[eventFields.endTime];\r\n        if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\r\n            var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\r\n            var endReferenceDate = new Date(startReferenceDate.getTime());\r\n            for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\r\n                endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\r\n                var eventObj = extend({}, event, null, true);\r\n                eventObj[eventFields.startTime] = new Date(startReferenceDate);\r\n                eventObj[eventFields.endTime] = new Date(endReferenceDate);\r\n                startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\r\n                eventData.push(eventObj);\r\n            }\r\n            var index = eventData.length - 1;\r\n            eventData[0][eventFields.startTime] = startTime;\r\n            eventData[index][eventFields.endTime] = endTime;\r\n        }\r\n        else {\r\n            eventData.push(event);\r\n        }\r\n        return eventData;\r\n    };\r\n    DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\r\n        var eventObj = extend({}, data, null, true);\r\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\r\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\r\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\r\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\r\n        }\r\n        var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\r\n            eventObj[this.parent.eventFields.startTime].getTime();\r\n        if (eventObj[this.parent.eventFields.isAllDay]) {\r\n            var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\r\n            var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\r\n            var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\r\n            eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\r\n            eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\r\n        }\r\n        else {\r\n            eventObj[this.parent.eventFields.startTime] =\r\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\r\n            eventObj[this.parent.eventFields.endTime] =\r\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\r\n        }\r\n        return eventObj;\r\n    };\r\n    DragAndDrop.prototype.getDayIndex = function (event) {\r\n        var eventObj = extend({}, event, null, true);\r\n        var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\r\n        var query = '';\r\n        var wrapper = cls.DAY_WRAPPER_CLASS;\r\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\r\n            wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\r\n        }\r\n        else {\r\n            wrapper = cls.WORK_CELLS_CLASS;\r\n        }\r\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\r\n        }\r\n        this.targetTd = this.parent.element.querySelector(query);\r\n        if (isNullOrUndefined(this.targetTd)) {\r\n            return -1;\r\n        }\r\n        return this.targetTd.cellIndex;\r\n    };\r\n    DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\r\n        this.verticalEvent.initializeValues();\r\n        var datesCount = 0;\r\n        if (!this.parent.uiStateValues.isGroupAdaptive) {\r\n            for (var i = 0; i < this.actionObj.groupIndex; i++) {\r\n                datesCount = datesCount + this.verticalEvent.dateRender[i].length;\r\n            }\r\n        }\r\n        var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\r\n        var target = (this.parent.activeViewOptions.group.byDate &&\r\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\r\n        if (target || !this.parent.activeViewOptions.group.byDate) {\r\n            var dynamicIndex = -1;\r\n            var dayIndex = !this.parent.activeViewOptions.group.byDate ?\r\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\r\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime(\r\n                // eslint-disable-next-line max-len\r\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\r\n            var splitEvents = this.splitEvent(event);\r\n            var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 ||\r\n                this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\r\n            for (var i = 0; i < events_1.length; i++) {\r\n                if (i > 0) {\r\n                    var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\r\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n                        filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\r\n                    }\r\n                    var appWrap = this.parent.element.querySelector(filterQuery);\r\n                    if (appWrap) {\r\n                        dayIndex = dayIndex + 1;\r\n                        dynamicIndex = appWrap.cellIndex;\r\n                    }\r\n                    else {\r\n                        dayIndex = -1;\r\n                    }\r\n                }\r\n                if (dayIndex >= 0) {\r\n                    var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\r\n                    var eStart = record[this.verticalEvent.fields.startTime];\r\n                    var eEnd = record[this.verticalEvent.fields.endTime];\r\n                    var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\r\n                        this.actionObj.element.offsetHeight;\r\n                    var topValue = this.parent.activeViewOptions.timeScale.enable ?\r\n                        this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\r\n                    if (isNullOrUndefined(index)) {\r\n                        if (i === 0) {\r\n                            this.actionObj.clone.style.top = formatUnit(topValue);\r\n                            this.actionObj.clone.style.height = formatUnit(appHeight);\r\n                        }\r\n                        else {\r\n                            this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\r\n                        }\r\n                    }\r\n                    else {\r\n                        var appWidth = this.actionObj.cellWidth;\r\n                        if (event[this.parent.eventFields.isAllDay]) {\r\n                            topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\r\n                            appHeight = this.getAllDayEventHeight();\r\n                            var timeDiff = event[this.parent.eventFields.endTime].getTime() -\r\n                                event[this.parent.eventFields.startTime].getTime();\r\n                            var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\r\n                            if (allDayDifference >= 0) {\r\n                                appWidth = (allDayDifference * this.actionObj.cellWidth);\r\n                            }\r\n                        }\r\n                        if (this.actionObj.cloneElement[index]) {\r\n                            if (i === 0) {\r\n                                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\r\n                                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\r\n                                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\r\n                                this.actionObj.cloneElement[index].style.left = formatUnit(0);\r\n                            }\r\n                            else {\r\n                                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\r\n        var startTime = record[this.parent.eventFields.startTime].getTime();\r\n        var endTime = record[this.parent.eventFields.endTime].getTime();\r\n        if (startTime !== endTime) {\r\n            var appointmentElement = this.verticalEvent.\r\n                createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\r\n            addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\r\n            setStyleAttribute(appointmentElement, {\r\n                'width': '100%',\r\n                'height': height + 'px',\r\n                'top': top + 'px',\r\n                'border': '0px'\r\n            });\r\n            var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\r\n            appointmentWrap[index].appendChild(appointmentElement);\r\n        }\r\n    };\r\n    DragAndDrop.prototype.getRenderedDates = function () {\r\n        var _this = this;\r\n        var _a, _b;\r\n        var renderDates = this.parent.activeView.renderDates;\r\n        (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) { return +date; }));\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            this.parent.eventBase.slots = [];\r\n            var resources = this.parent.resourceBase.lastResourceLevel.\r\n                filter(function (res) { return res.groupIndex === _this.actionObj.groupIndex; });\r\n            renderDates = resources[0].renderDates;\r\n            (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) { return +date; }));\r\n        }\r\n        return renderDates;\r\n    };\r\n    DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\r\n        this.parent.eventBase.slots = [];\r\n        var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\r\n        var renderDates = this.getRenderedDates();\r\n        var events = this.parent.eventBase.splitEvent(event, renderDates);\r\n        var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\r\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\r\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\r\n        }\r\n        var cell = [].slice.call(this.parent.element.querySelectorAll(query));\r\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\r\n            var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\r\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\r\n            // eslint-disable-next-line max-len\r\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\r\n        }\r\n    };\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    DragAndDrop.prototype.swapDragging = function (e) {\r\n        var colIndex = closest(this.actionObj.target, 'td').cellIndex;\r\n        if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) &&\r\n            !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\r\n            addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\r\n            this.appendCloneElement(this.getEventWrapper(colIndex));\r\n            this.actionObj.isAllDay = true;\r\n            var eventHeight = this.getAllDayEventHeight();\r\n            var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\r\n            if (allDayElement[0].offsetHeight < eventHeight) {\r\n                for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\r\n                    var element = allDayElement_1[_i];\r\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\r\n                }\r\n            }\r\n            setStyleAttribute(this.actionObj.clone, {\r\n                width: formatUnit(this.actionObj.cellWidth),\r\n                height: formatUnit(eventHeight),\r\n                top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\r\n            });\r\n        }\r\n        if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) &&\r\n            !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\r\n            removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\r\n            this.appendCloneElement(this.getEventWrapper(colIndex));\r\n            this.actionObj.isAllDay = false;\r\n            // eslint-disable-next-line max-len\r\n            var height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\r\n            setStyleAttribute(this.actionObj.clone, {\r\n                left: formatUnit(0),\r\n                height: formatUnit(height),\r\n                width: formatUnit(this.actionObj.cellWidth)\r\n            });\r\n        }\r\n    };\r\n    DragAndDrop.prototype.calculateVerticalDate = function (e) {\r\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\r\n            (e.target && e.target.tagName === 'DIV')) {\r\n            return;\r\n        }\r\n        var eventObj = extend({}, this.actionObj.event, null, true);\r\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\r\n            this.removeCloneElement();\r\n        }\r\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\r\n            eventObj[this.parent.eventFields.startTime].getTime();\r\n        var td = closest(this.actionObj.target, 'td');\r\n        if (!isNullOrUndefined(td)) {\r\n            var tr = td.parentElement;\r\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\r\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\r\n            td = workCells[this.actionObj.index];\r\n            var currentDate = this.parent.getDateFromElement(td);\r\n            if (!isNullOrUndefined(currentDate)) {\r\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\r\n                }\r\n                var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\r\n                var dragStart = new Date(timeString.getTime());\r\n                var dragEnd = new Date(dragStart.getTime());\r\n                var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() -\r\n                    (util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime]))).getTime();\r\n                dragStart = new Date(dragStart.getTime() + startTimeDiff);\r\n                dragEnd = new Date(dragStart.getTime() + eventDuration);\r\n                this.actionObj.start = new Date(dragStart.getTime());\r\n                this.actionObj.end = new Date(dragEnd.getTime());\r\n            }\r\n        }\r\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\r\n        var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\r\n        for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\r\n            var wrapper = eventWrappers_1[_i];\r\n            remove(wrapper);\r\n        }\r\n        if (this.multiData && this.multiData.length > 0) {\r\n            var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\r\n            var startTimeDiff = startTime.getTime() - this.startTime;\r\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\r\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\r\n                startTimeDiff -= new Date(this.startTime).getMonth();\r\n                startTimeDiff += startTime.getMonth();\r\n            }\r\n            for (var index = 0; index < this.multiData.length; index++) {\r\n                this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\r\n                if (this.parent.currentView === 'TimelineYear') {\r\n                    this.dynamicYearlyEventsRendering(this.updatedData[index]);\r\n                }\r\n                else {\r\n                    this.dynamicEventsRendering(this.updatedData[index]);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (this.parent.currentView === 'TimelineYear') {\r\n                this.dynamicYearlyEventsRendering(event);\r\n            }\r\n            else {\r\n                this.dynamicEventsRendering(event);\r\n            }\r\n        }\r\n    };\r\n    DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\r\n        var eventObj = extend({}, data, null, true);\r\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\r\n            eventObj[this.parent.eventFields.startTime].getTime();\r\n        var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\r\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\r\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\r\n        }\r\n        else {\r\n            var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\r\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\r\n        }\r\n        eventObj[this.parent.eventFields.endTime] =\r\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\r\n        return eventObj;\r\n    };\r\n    DragAndDrop.prototype.calculateTimelineTime = function (e) {\r\n        var eventObj = extend({}, this.actionObj.event, null, true);\r\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\r\n            eventObj[this.parent.eventFields.startTime].getTime();\r\n        var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\r\n            parseInt(this.actionObj.clone.style.left, 10);\r\n        offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\r\n        var rightOffset;\r\n        if (this.parent.enableRtl) {\r\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\r\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\r\n        }\r\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\r\n        var colIndex = this.getColumnIndex(offsetLeft);\r\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\r\n        var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl &&\r\n            this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right &&\r\n            !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\r\n        var leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\r\n        if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\r\n            this.isCursorAhead = true;\r\n        }\r\n        var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\r\n        if (this.parent.enableRtl) {\r\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\r\n                this.actionObj.cellWidth)) - 1;\r\n        }\r\n        if (this.cursorPointIndex < 0) {\r\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\r\n        }\r\n        var tr = this.parent.getContentTable().querySelector('tr');\r\n        var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\r\n        index = index < 0 ? 0 : index;\r\n        var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) :\r\n            this.parent.getDateFromElement(tr.children[index]);\r\n        if (this.isStepDragging) {\r\n            var widthDiff = this.getWidthDiff(tr, index);\r\n            if (widthDiff !== 0) {\r\n                var timeDiff = Math.round(widthDiff / this.widthPerMinute);\r\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\r\n                if (this.isCursorAhead || cursorDrag) {\r\n                    eventStart.setMilliseconds(-(eventDuration));\r\n                }\r\n                else {\r\n                    eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\r\n                }\r\n            }\r\n            else {\r\n                eventStart = this.actionObj.start;\r\n            }\r\n        }\r\n        else {\r\n            if (this.isCursorAhead || cursorDrag) {\r\n                eventStart.setMinutes(eventStart.getMinutes() +\r\n                    (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\r\n                eventStart.setMilliseconds(-(eventDuration));\r\n            }\r\n            else {\r\n                eventStart.setMinutes(eventStart.getMinutes() -\r\n                    (this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\r\n            }\r\n        }\r\n        eventStart = this.calculateIntervalTime(eventStart);\r\n        if (this.isTimelineDayProcess) {\r\n            var eventSrt = eventObj[this.parent.eventFields.startTime];\r\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\r\n        }\r\n        if (this.parent.eventDragArea) {\r\n            var targetDate = this.parent.getDateFromElement(e.target);\r\n            if (!isNullOrUndefined(targetDate)) {\r\n                if (!this.parent.activeViewOptions.timeScale.enable || (this.parent.currentView === 'TimelineMonth')) {\r\n                    var eventSrt = eventObj[this.parent.eventFields.startTime];\r\n                    eventStart = new Date(eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\r\n                }\r\n                else {\r\n                    eventStart = targetDate;\r\n                }\r\n            }\r\n        }\r\n        var eventEnd = new Date(eventStart.getTime());\r\n        eventEnd.setMilliseconds(eventDuration);\r\n        var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\r\n        if (this.multiData.length > 0) {\r\n            var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\r\n            for (var i = 0; i < this.multiData.length; i++) {\r\n                this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\r\n            }\r\n            eventsData = this.updatedData;\r\n        }\r\n        for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\r\n            var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\r\n            var eventData = events_2[0].data;\r\n            var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\r\n            var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData);\r\n            // eslint-disable-next-line max-len\r\n            var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\r\n            // eslint-disable-next-line max-len\r\n            var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\r\n            day = day < 0 ? 0 : day;\r\n            var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\r\n            var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\r\n            if (this.parent.enableRtl) {\r\n                cloneElement.style.right = formatUnit(left);\r\n            }\r\n            else {\r\n                cloneElement.style.left = formatUnit(left);\r\n            }\r\n            if (!this.isMorePopupOpened) {\r\n                cloneElement.style.width = formatUnit(width);\r\n            }\r\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n                this.calculateResourceGroupingPosition(e, cloneElement);\r\n            }\r\n            this.actionObj.start = new Date(eventStart.getTime());\r\n            this.actionObj.end = new Date(eventEnd.getTime());\r\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\r\n        }\r\n    };\r\n    DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\r\n        if (this.scrollEdges.left || this.scrollEdges.right) {\r\n            var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n            if (this.parent.enableRtl) {\r\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\r\n                if (this.scrollEdges.right) {\r\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\r\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\r\n                }\r\n                else {\r\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\r\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\r\n                        this.actionObj.clone.style.width =\r\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\r\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\r\n                    }\r\n                }\r\n                this.actionObj.clone.style.left = formatUnit(rightOffset);\r\n            }\r\n            else {\r\n                if (this.scrollEdges.left) {\r\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\r\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\r\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\r\n                    }\r\n                    else if (this.actionObj.clone.offsetLeft === 0) {\r\n                        offsetLeft = viewEle.scrollLeft;\r\n                    }\r\n                }\r\n                else {\r\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\r\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\r\n                }\r\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\r\n                this.actionObj.clone.style.left = formatUnit(offsetLeft);\r\n            }\r\n        }\r\n        return offsetLeft;\r\n    };\r\n    DragAndDrop.prototype.getWidthDiff = function (tr, index) {\r\n        var pages = this.scrollArgs.element.getBoundingClientRect();\r\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\r\n            var targetLeft = tr.children[index].offsetLeft;\r\n            var pageX = this.actionObj.pageX - pages.left;\r\n            if (this.parent.enableRtl) {\r\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\r\n            }\r\n            else {\r\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\r\n        var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\r\n        if (this.isHeaderRows) {\r\n            return index;\r\n        }\r\n        return this.getIndex(index);\r\n    };\r\n    DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\r\n        var index = colIndex + cloneIndex;\r\n        if (this.isHeaderRows) {\r\n            var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\r\n            return (index > dateLength - 1) ? dateLength - 1 : index;\r\n        }\r\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\r\n    };\r\n    DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\r\n        var td = closest(e.target, '.e-work-cells');\r\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\r\n            var targetDate = this.parent.getDateFromElement(td);\r\n            if (this.isHeaderRows) {\r\n                var currentIndex = Math.floor(left / this.actionObj.cellWidth);\r\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\r\n            }\r\n            var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\r\n            if (this.isTimelineDayProcess) {\r\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (util.MS_PER_DAY)));\r\n            }\r\n            else {\r\n                var widthDiff = Math.floor((timeDiff / util.MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\r\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\r\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\r\n            }\r\n        }\r\n        else {\r\n            this.cursorPointIndex = 0;\r\n        }\r\n    };\r\n    DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\r\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n        var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\r\n        var translateY = util.getTranslateY(dragArea.querySelector('table'));\r\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\r\n        var rowHeight = (this.parent.rowAutoHeight) ?\r\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\r\n        var rowIndex = Math.floor(Math.floor((this.actionObj.Y +\r\n            (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset))) -\r\n            dragArea.getBoundingClientRect().top) / rowHeight);\r\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\r\n        this.actionObj.index = rowIndex;\r\n        var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\r\n        var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\r\n        if (!eventWrapper) {\r\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\r\n            eventContainer.appendChild(eventWrapper);\r\n        }\r\n        this.appendCloneElement(eventWrapper, cloneElement);\r\n        var td = closest(this.actionObj.target, 'td');\r\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\r\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\r\n        var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\r\n        if (this.parent.rowAutoHeight) {\r\n            var cursorElement = this.getCursorElement(e);\r\n            if (cursorElement) {\r\n                top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop :\r\n                    cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ?\r\n                        cursorElement.offsetParent.offsetTop : top;\r\n            }\r\n        }\r\n        cloneElement.style.top = formatUnit(top);\r\n    };\r\n    DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\r\n        if (cloneElement === void 0) { cloneElement = null; }\r\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\r\n        var dragElement = document.querySelector(this.parent.eventDragArea);\r\n        if (this.parent.eventDragArea && dragElement) {\r\n            dragElement.appendChild(cloneElement);\r\n        }\r\n        else {\r\n            element.appendChild(cloneElement);\r\n        }\r\n    };\r\n    DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\r\n        var eventWrapper;\r\n        if (isNullOrUndefined(isAllDayDrag)) {\r\n            isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\r\n        }\r\n        if (this.parent.activeViewOptions.timeScale.enable) {\r\n            var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\r\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\r\n        }\r\n        else {\r\n            var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\r\n            eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\r\n            if (!eventWrapper) {\r\n                eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\r\n                targetWrapper.appendChild(eventWrapper);\r\n            }\r\n        }\r\n        return eventWrapper;\r\n    };\r\n    DragAndDrop.prototype.getAllDayEventHeight = function () {\r\n        var eventWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS });\r\n        this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\r\n        var eventHeight = eventWrapper.offsetHeight;\r\n        remove(eventWrapper);\r\n        return eventHeight;\r\n    };\r\n    DragAndDrop.prototype.isAllowDrop = function (e) {\r\n        if (!this.actionObj.excludeSelectors) {\r\n            return false;\r\n        }\r\n        var dropSelectors = this.actionObj.excludeSelectors.split(',');\r\n        var isAllowDrop = false;\r\n        for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\r\n            var selector = dropSelectors_1[_i];\r\n            if (e.target.classList.contains(selector)) {\r\n                isAllowDrop = true;\r\n                break;\r\n            }\r\n        }\r\n        return isAllowDrop;\r\n    };\r\n    /**\r\n     * Get module name.\r\n     *\r\n     * @returns {string} Returns the module name\r\n     */\r\n    DragAndDrop.prototype.getModuleName = function () {\r\n        return 'dragAndDrop';\r\n    };\r\n    return DragAndDrop;\r\n}(ActionBase));\r\nexport { DragAndDrop };\r\n"]},"metadata":{},"sourceType":"module"}