{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Workbook } from '@syncfusion/ej2-excel-export';\nimport { extend } from '@syncfusion/ej2-base';\n/**\r\n * Excel Export Module\r\n */\n\nvar ExcelExport =\n/** @class */\nfunction () {\n  function ExcelExport(parent) {\n    this.parent = parent;\n  }\n\n  ExcelExport.prototype.initializeExcelExport = function (excelExportOptions) {\n    if (excelExportOptions === void 0) {\n      excelExportOptions = {};\n    }\n\n    var exportColumns = this.getExportColumns(excelExportOptions);\n    var exportName = excelExportOptions.fileName || 'Schedule';\n    var exportType = excelExportOptions.exportType || 'xlsx';\n    var isIncludeOccurrences = excelExportOptions.includeOccurrences || false;\n    var eventCollection;\n\n    if (excelExportOptions.customData) {\n      eventCollection = !isIncludeOccurrences ? excelExportOptions.customData : this.parent.eventBase.getProcessedEvents(excelExportOptions.customData);\n    } else {\n      eventCollection = !isIncludeOccurrences ? this.parent.eventsData : this.parent.eventsProcessed;\n    }\n\n    this.processWorkbook(exportColumns, exportName, exportType, eventCollection);\n  };\n\n  ExcelExport.prototype.processWorkbook = function (fields, name, type, eventCollection) {\n    var _this = this;\n\n    var columns = [];\n    var rows = [];\n    var columnHeader = [];\n    fields.forEach(function (field, i) {\n      columns.push({\n        index: i + 1,\n        width: field.name === 'Id' ? 50 : 150\n      });\n    });\n    var style = {\n      fontSize: 12,\n      borders: {\n        color: '#E0E0E0'\n      },\n      bold: true\n    };\n    fields.forEach(function (field, i) {\n      columnHeader.push({\n        index: i + 1,\n        value: field.text,\n        style: style\n      });\n    });\n    rows.push({\n      index: 1,\n      cells: columnHeader\n    });\n    eventCollection.forEach(function (event, i) {\n      var columnData = [];\n      fields.forEach(function (field, n) {\n        var columnRule = {\n          index: n + 1,\n          value: event[field.name] || ''\n        };\n\n        if (field.name === _this.parent.eventFields.startTime || field.name === _this.parent.eventFields.endTime) {\n          var styleRule = {\n            fontSize: 12,\n            numberFormat: 'm/d/yyyy h:mm AM/PM'\n          };\n          columnRule = extend({}, columnRule, {\n            style: styleRule\n          }, true);\n        }\n\n        columnData.push(columnRule);\n      });\n      rows.push({\n        index: i + 2,\n        cells: columnData\n      });\n    });\n    var workSheet = [{\n      columns: columns,\n      rows: rows\n    }];\n    var book = new Workbook({\n      worksheets: workSheet\n    }, type, this.parent.locale);\n    book.save(name + '.' + type);\n  };\n\n  ExcelExport.prototype.getExportColumns = function (exportOptions) {\n    var _this = this;\n\n    var exportColumns = exportOptions.fieldsInfo || [];\n\n    if (exportColumns.length === 0) {\n      var fields = exportOptions.fields || Object.keys(this.parent.eventFields).map(function (field) {\n        return _this.parent.eventFields[field];\n      });\n      fields.forEach(function (field) {\n        exportColumns.push({\n          name: field,\n          text: field\n        });\n      });\n    }\n\n    return exportColumns;\n  };\n\n  ExcelExport.prototype.getModuleName = function () {\n    return 'excelExport';\n  };\n\n  ExcelExport.prototype.destroy = function () {\n    this.parent = null;\n  };\n\n  return ExcelExport;\n}();\n\nexport { ExcelExport };","map":{"version":3,"sources":["C:/Users/nvtung/Các project thực hiện/CNPM/RubyGYM/client/node_modules/@syncfusion/ej2-schedule/src/schedule/exports/excel-export.js"],"names":["Workbook","extend","ExcelExport","parent","prototype","initializeExcelExport","excelExportOptions","exportColumns","getExportColumns","exportName","fileName","exportType","isIncludeOccurrences","includeOccurrences","eventCollection","customData","eventBase","getProcessedEvents","eventsData","eventsProcessed","processWorkbook","fields","name","type","_this","columns","rows","columnHeader","forEach","field","i","push","index","width","style","fontSize","borders","color","bold","value","text","cells","event","columnData","n","columnRule","eventFields","startTime","endTime","styleRule","numberFormat","workSheet","book","worksheets","locale","save","exportOptions","fieldsInfo","length","Object","keys","map","getModuleName","destroy"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { Workbook } from '@syncfusion/ej2-excel-export';\r\nimport { extend } from '@syncfusion/ej2-base';\r\n/**\r\n * Excel Export Module\r\n */\r\nvar ExcelExport = /** @class */ (function () {\r\n    function ExcelExport(parent) {\r\n        this.parent = parent;\r\n    }\r\n    ExcelExport.prototype.initializeExcelExport = function (excelExportOptions) {\r\n        if (excelExportOptions === void 0) { excelExportOptions = {}; }\r\n        var exportColumns = this.getExportColumns(excelExportOptions);\r\n        var exportName = excelExportOptions.fileName || 'Schedule';\r\n        var exportType = excelExportOptions.exportType || 'xlsx';\r\n        var isIncludeOccurrences = excelExportOptions.includeOccurrences || false;\r\n        var eventCollection;\r\n        if (excelExportOptions.customData) {\r\n            eventCollection = !isIncludeOccurrences ? excelExportOptions.customData :\r\n                this.parent.eventBase.getProcessedEvents(excelExportOptions.customData);\r\n        }\r\n        else {\r\n            eventCollection = !isIncludeOccurrences ? this.parent.eventsData : this.parent.eventsProcessed;\r\n        }\r\n        this.processWorkbook(exportColumns, exportName, exportType, eventCollection);\r\n    };\r\n    ExcelExport.prototype.processWorkbook = function (fields, name, type, eventCollection) {\r\n        var _this = this;\r\n        var columns = [];\r\n        var rows = [];\r\n        var columnHeader = [];\r\n        fields.forEach(function (field, i) { columns.push({ index: i + 1, width: (field.name === 'Id' ? 50 : 150) }); });\r\n        var style = { fontSize: 12, borders: { color: '#E0E0E0' }, bold: true };\r\n        fields.forEach(function (field, i) { columnHeader.push({ index: i + 1, value: field.text, style: style }); });\r\n        rows.push({ index: 1, cells: columnHeader });\r\n        eventCollection.forEach(function (event, i) {\r\n            var columnData = [];\r\n            fields.forEach(function (field, n) {\r\n                var columnRule = { index: n + 1, value: event[field.name] || '' };\r\n                if (field.name === _this.parent.eventFields.startTime || field.name === _this.parent.eventFields.endTime) {\r\n                    var styleRule = { fontSize: 12, numberFormat: 'm/d/yyyy h:mm AM/PM' };\r\n                    columnRule = extend({}, columnRule, { style: styleRule }, true);\r\n                }\r\n                columnData.push(columnRule);\r\n            });\r\n            rows.push({ index: i + 2, cells: columnData });\r\n        });\r\n        var workSheet = [{ columns: columns, rows: rows }];\r\n        var book = new Workbook({ worksheets: workSheet }, type, this.parent.locale);\r\n        book.save(name + '.' + type);\r\n    };\r\n    ExcelExport.prototype.getExportColumns = function (exportOptions) {\r\n        var _this = this;\r\n        var exportColumns = exportOptions.fieldsInfo || [];\r\n        if (exportColumns.length === 0) {\r\n            var fields = exportOptions.fields || Object.keys(this.parent.eventFields).map(function (field) {\r\n                return _this.parent.eventFields[field];\r\n            });\r\n            fields.forEach(function (field) { exportColumns.push({ name: field, text: field }); });\r\n        }\r\n        return exportColumns;\r\n    };\r\n    ExcelExport.prototype.getModuleName = function () {\r\n        return 'excelExport';\r\n    };\r\n    ExcelExport.prototype.destroy = function () {\r\n        this.parent = null;\r\n    };\r\n    return ExcelExport;\r\n}());\r\nexport { ExcelExport };\r\n"]},"metadata":{},"sourceType":"module"}